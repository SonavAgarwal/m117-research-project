{
    "sha": "dae026a0f0511f83852053bae9d5a622e7f80486",
    "node_id": "MDY6Q29tbWl0MTU5Mjg2NTA6ZGFlMDI2YTBmMDUxMWY4Mzg1MjA1M2JhZTlkNWE2MjJlN2Y4MDQ4Ng==",
    "commit": {
        "author": {
            "name": "Donald J. Brown",
            "email": "mrdon@apache.org",
            "date": "2008-01-25T13:13:23Z"
        },
        "committer": {
            "name": "Donald J. Brown",
            "email": "mrdon@apache.org",
            "date": "2008-01-25T13:13:23Z"
        },
        "message": "Adding a check for double quotes to help prevent XSS attacks\nWW-2427\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/struts/struts2/trunk@615212 13f79535-47bb-0310-9956-ffa450edef68",
        "tree": {
            "sha": "6d0415d65412749625b21a2ec3155e950265cb5d",
            "url": "https://api.github.com/repos/apache/struts/git/trees/6d0415d65412749625b21a2ec3155e950265cb5d"
        },
        "url": "https://api.github.com/repos/apache/struts/git/commits/dae026a0f0511f83852053bae9d5a622e7f80486",
        "comment_count": 0,
        "verification": {
            "verified": false,
            "reason": "unsigned",
            "signature": null,
            "payload": null,
            "verified_at": null
        }
    },
    "url": "https://api.github.com/repos/apache/struts/commits/dae026a0f0511f83852053bae9d5a622e7f80486",
    "html_url": "https://github.com/apache/struts/commit/dae026a0f0511f83852053bae9d5a622e7f80486",
    "comments_url": "https://api.github.com/repos/apache/struts/commits/dae026a0f0511f83852053bae9d5a622e7f80486/comments",
    "author": null,
    "committer": null,
    "parents": [
        {
            "sha": "7e169a93e2772eb861d5a833e54b9ef4c031567b",
            "url": "https://api.github.com/repos/apache/struts/commits/7e169a93e2772eb861d5a833e54b9ef4c031567b",
            "html_url": "https://github.com/apache/struts/commit/7e169a93e2772eb861d5a833e54b9ef4c031567b"
        }
    ],
    "stats": {
        "total": 37,
        "additions": 35,
        "deletions": 2
    },
    "files": [
        {
            "sha": "374cc3b63c8c45ac6d89745552846aa192c520eb",
            "filename": "core/src/main/java/org/apache/struts2/components/Anchor.java",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/apache/struts/blob/dae026a0f0511f83852053bae9d5a622e7f80486/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fcomponents%2FAnchor.java",
            "raw_url": "https://github.com/apache/struts/raw/dae026a0f0511f83852053bae9d5a622e7f80486/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fcomponents%2FAnchor.java",
            "contents_url": "https://api.github.com/repos/apache/struts/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fcomponents%2FAnchor.java?ref=dae026a0f0511f83852053bae9d5a622e7f80486",
            "patch": "@@ -74,9 +74,9 @@ public void evaluateExtraParams() {\n         super.evaluateExtraParams();\n \n         if (href != null)\n-            addParameter(\"href\", findString(href));\n+            addParameter(\"href\", ensureAttributeSafelyNotEscaped(findString(href)));\n     }\n-    \n+\n     @StrutsTagAttribute(description=\"The URL.\")\n     public void setHref(String href) {\n         this.href = href;"
        },
        {
            "sha": "722d530b3aeb01ab6501b5dc206852b224e788e9",
            "filename": "core/src/main/java/org/apache/struts2/components/UIBean.java",
            "status": "modified",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/apache/struts/blob/dae026a0f0511f83852053bae9d5a622e7f80486/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fcomponents%2FUIBean.java",
            "raw_url": "https://github.com/apache/struts/raw/dae026a0f0511f83852053bae9d5a622e7f80486/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fcomponents%2FUIBean.java",
            "contents_url": "https://api.github.com/repos/apache/struts/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fcomponents%2FUIBean.java?ref=dae026a0f0511f83852053bae9d5a622e7f80486",
            "patch": "@@ -837,6 +837,20 @@ protected String escape(String name) {\n         }\n     }\n \n+    /**\n+     * Ensures an unescaped attribute value cannot be vulnerable to XSS attacks\n+     *\n+     * @param val The value to check\n+     * @return The escaped value\n+     */\n+    protected String ensureAttributeSafelyNotEscaped(String val) {\n+        if (val != null) {\n+            return val.replaceAll(\"\\\"\", \"&#34;\");\n+        } else {\n+            return \"\";\n+        }\n+    }\n+\n     protected void evaluateExtraParams() {\n     }\n "
        },
        {
            "sha": "eee793c90116ea74259fd662f707c9199982f29e",
            "filename": "core/src/test/java/org/apache/struts2/views/jsp/ui/AnchorTest.java",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/apache/struts/blob/dae026a0f0511f83852053bae9d5a622e7f80486/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fstruts2%2Fviews%2Fjsp%2Fui%2FAnchorTest.java",
            "raw_url": "https://github.com/apache/struts/raw/dae026a0f0511f83852053bae9d5a622e7f80486/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fstruts2%2Fviews%2Fjsp%2Fui%2FAnchorTest.java",
            "contents_url": "https://api.github.com/repos/apache/struts/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fstruts2%2Fviews%2Fjsp%2Fui%2FAnchorTest.java?ref=dae026a0f0511f83852053bae9d5a622e7f80486",
            "patch": "@@ -43,6 +43,21 @@ public void testSimple() throws Exception {\n         verify(AnchorTest.class.getResource(\"href-1.txt\"));\n     }\n \n+    public void testSimpleBadQuote() throws Exception {\n+        TestAction testAction = (TestAction) action;\n+        testAction.setFoo(\"bar\");\n+\n+        AnchorTag tag = new AnchorTag();\n+        tag.setPageContext(pageContext);\n+\n+        tag.setId(\"mylink\");\n+        tag.setHref(\"a\\\"\");\n+        tag.doStartTag();\n+        tag.doEndTag();\n+\n+        verify(AnchorTest.class.getResource(\"href-2.txt\"));\n+    }\n+\n     public void testDynamicAttribute() throws Exception {\n         TestAction testAction = (TestAction) action;\n         testAction.setFoo(\"bar\");"
        },
        {
            "sha": "cfcf57184b1ff593373c0b05c4c9f1a96d6eb005",
            "filename": "core/src/test/resources/org/apache/struts2/views/jsp/ui/href-2.txt",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/apache/struts/blob/dae026a0f0511f83852053bae9d5a622e7f80486/core%2Fsrc%2Ftest%2Fresources%2Forg%2Fapache%2Fstruts2%2Fviews%2Fjsp%2Fui%2Fhref-2.txt",
            "raw_url": "https://github.com/apache/struts/raw/dae026a0f0511f83852053bae9d5a622e7f80486/core%2Fsrc%2Ftest%2Fresources%2Forg%2Fapache%2Fstruts2%2Fviews%2Fjsp%2Fui%2Fhref-2.txt",
            "contents_url": "https://api.github.com/repos/apache/struts/contents/core%2Fsrc%2Ftest%2Fresources%2Forg%2Fapache%2Fstruts2%2Fviews%2Fjsp%2Fui%2Fhref-2.txt?ref=dae026a0f0511f83852053bae9d5a622e7f80486",
            "patch": "@@ -0,0 +1,4 @@\n+<a\n+ id=\"mylink\"\n+ href=\"a&#34;\">\n+</a>"
        }
    ]
}