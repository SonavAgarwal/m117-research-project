{
    "sha": "87172cfc1dd7f8f6e137963c778b03efd14ac446",
    "node_id": "MDY6Q29tbWl0MzIyMTk2MjQ6ODcxNzJjZmMxZGQ3ZjhmNmUxMzc5NjNjNzc4YjAzZWZkMTRhYzQ0Ng==",
    "commit": {
        "author": {
            "name": "joehni",
            "email": "joerg.schaible@gmx.de",
            "date": "2015-10-01T18:01:45Z"
        },
        "committer": {
            "name": "joehni",
            "email": "joerg.schaible@gmx.de",
            "date": "2015-10-01T18:01:45Z"
        },
        "message": "Fix XXE vulnerability for JDom parsers.",
        "tree": {
            "sha": "841863809759e449aa6723041f93ce31ddf9a6f0",
            "url": "https://api.github.com/repos/x-stream/xstream/git/trees/841863809759e449aa6723041f93ce31ddf9a6f0"
        },
        "url": "https://api.github.com/repos/x-stream/xstream/git/commits/87172cfc1dd7f8f6e137963c778b03efd14ac446",
        "comment_count": 0,
        "verification": {
            "verified": false,
            "reason": "unsigned",
            "signature": null,
            "payload": null,
            "verified_at": null
        }
    },
    "url": "https://api.github.com/repos/x-stream/xstream/commits/87172cfc1dd7f8f6e137963c778b03efd14ac446",
    "html_url": "https://github.com/x-stream/xstream/commit/87172cfc1dd7f8f6e137963c778b03efd14ac446",
    "comments_url": "https://api.github.com/repos/x-stream/xstream/commits/87172cfc1dd7f8f6e137963c778b03efd14ac446/comments",
    "author": {
        "login": "joehni",
        "id": 795149,
        "node_id": "MDQ6VXNlcjc5NTE0OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/795149?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/joehni",
        "html_url": "https://github.com/joehni",
        "followers_url": "https://api.github.com/users/joehni/followers",
        "following_url": "https://api.github.com/users/joehni/following{/other_user}",
        "gists_url": "https://api.github.com/users/joehni/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/joehni/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/joehni/subscriptions",
        "organizations_url": "https://api.github.com/users/joehni/orgs",
        "repos_url": "https://api.github.com/users/joehni/repos",
        "events_url": "https://api.github.com/users/joehni/events{/privacy}",
        "received_events_url": "https://api.github.com/users/joehni/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "committer": {
        "login": "joehni",
        "id": 795149,
        "node_id": "MDQ6VXNlcjc5NTE0OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/795149?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/joehni",
        "html_url": "https://github.com/joehni",
        "followers_url": "https://api.github.com/users/joehni/followers",
        "following_url": "https://api.github.com/users/joehni/following{/other_user}",
        "gists_url": "https://api.github.com/users/joehni/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/joehni/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/joehni/subscriptions",
        "organizations_url": "https://api.github.com/users/joehni/orgs",
        "repos_url": "https://api.github.com/users/joehni/repos",
        "events_url": "https://api.github.com/users/joehni/events{/privacy}",
        "received_events_url": "https://api.github.com/users/joehni/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "parents": [
        {
            "sha": "0311e0f9cf23e4bdaed6ccca1afdd91cb5f448d5",
            "url": "https://api.github.com/repos/x-stream/xstream/commits/0311e0f9cf23e4bdaed6ccca1afdd91cb5f448d5",
            "html_url": "https://github.com/x-stream/xstream/commit/0311e0f9cf23e4bdaed6ccca1afdd91cb5f448d5"
        }
    ],
    "stats": {
        "total": 54,
        "additions": 38,
        "deletions": 16
    },
    "files": [
        {
            "sha": "01063d0ad3afac70efc58d200c63ac9fbdff54ff",
            "filename": "xstream/src/java/com/thoughtworks/xstream/io/xml/JDom2Driver.java",
            "status": "modified",
            "additions": 16,
            "deletions": 4,
            "changes": 20,
            "blob_url": "https://github.com/x-stream/xstream/blob/87172cfc1dd7f8f6e137963c778b03efd14ac446/xstream%2Fsrc%2Fjava%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FJDom2Driver.java",
            "raw_url": "https://github.com/x-stream/xstream/raw/87172cfc1dd7f8f6e137963c778b03efd14ac446/xstream%2Fsrc%2Fjava%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FJDom2Driver.java",
            "contents_url": "https://api.github.com/repos/x-stream/xstream/contents/xstream%2Fsrc%2Fjava%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FJDom2Driver.java?ref=87172cfc1dd7f8f6e137963c778b03efd14ac446",
            "patch": "@@ -49,7 +49,7 @@ public JDom2Driver(final NameCoder nameCoder) {\n     @Override\n     public HierarchicalStreamReader createReader(final Reader reader) {\n         try {\n-            final SAXBuilder builder = new SAXBuilder();\n+            final SAXBuilder builder = createBuilder();\n             final Document document = builder.build(reader);\n             return new JDom2Reader(document, getNameCoder());\n         } catch (final IOException e) {\n@@ -62,7 +62,7 @@ public HierarchicalStreamReader createReader(final Reader reader) {\n     @Override\n     public HierarchicalStreamReader createReader(final InputStream in) {\n         try {\n-            final SAXBuilder builder = new SAXBuilder();\n+            final SAXBuilder builder = createBuilder();\n             final Document document = builder.build(in);\n             return new JDom2Reader(document, getNameCoder());\n         } catch (final IOException e) {\n@@ -75,7 +75,7 @@ public HierarchicalStreamReader createReader(final InputStream in) {\n     @Override\n     public HierarchicalStreamReader createReader(final URL in) {\n         try {\n-            final SAXBuilder builder = new SAXBuilder();\n+            final SAXBuilder builder = createBuilder();\n             final Document document = builder.build(in);\n             return new JDom2Reader(document, getNameCoder());\n         } catch (final IOException e) {\n@@ -88,7 +88,7 @@ public HierarchicalStreamReader createReader(final URL in) {\n     @Override\n     public HierarchicalStreamReader createReader(final File in) {\n         try {\n-            final SAXBuilder builder = new SAXBuilder();\n+            final SAXBuilder builder = createBuilder();\n             final Document document = builder.build(in);\n             return new JDom2Reader(document, getNameCoder());\n         } catch (final IOException e) {\n@@ -107,4 +107,16 @@ public HierarchicalStreamWriter createWriter(final Writer out) {\n     public HierarchicalStreamWriter createWriter(final OutputStream out) {\n         return new PrettyPrintWriter(new OutputStreamWriter(out));\n     }\n+\n+    /**\n+     * Create and initialize the SAX builder.\n+     * \n+     * @return the SAX builder instance.\n+     * @since upcoming\n+     */\n+    protected SAXBuilder createBuilder() {\n+        final SAXBuilder builder = new SAXBuilder();\n+        builder.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n+        return builder;\n+    }\n }"
        },
        {
            "sha": "aa71ae4216d32fba9e09e8d7553f8ccbe68cc9c6",
            "filename": "xstream/src/java/com/thoughtworks/xstream/io/xml/JDomDriver.java",
            "status": "modified",
            "additions": 16,
            "deletions": 4,
            "changes": 20,
            "blob_url": "https://github.com/x-stream/xstream/blob/87172cfc1dd7f8f6e137963c778b03efd14ac446/xstream%2Fsrc%2Fjava%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FJDomDriver.java",
            "raw_url": "https://github.com/x-stream/xstream/raw/87172cfc1dd7f8f6e137963c778b03efd14ac446/xstream%2Fsrc%2Fjava%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FJDomDriver.java",
            "contents_url": "https://api.github.com/repos/x-stream/xstream/contents/xstream%2Fsrc%2Fjava%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FJDomDriver.java?ref=87172cfc1dd7f8f6e137963c778b03efd14ac446",
            "patch": "@@ -58,7 +58,7 @@ public JDomDriver(final XmlFriendlyReplacer replacer) {\n     @Override\n     public HierarchicalStreamReader createReader(final Reader reader) {\n         try {\n-            final SAXBuilder builder = new SAXBuilder();\n+            final SAXBuilder builder = createBuilder();\n             final Document document = builder.build(reader);\n             return new JDomReader(document, getNameCoder());\n         } catch (final IOException e) {\n@@ -71,7 +71,7 @@ public HierarchicalStreamReader createReader(final Reader reader) {\n     @Override\n     public HierarchicalStreamReader createReader(final InputStream in) {\n         try {\n-            final SAXBuilder builder = new SAXBuilder();\n+            final SAXBuilder builder = createBuilder();\n             final Document document = builder.build(in);\n             return new JDomReader(document, getNameCoder());\n         } catch (final IOException e) {\n@@ -84,7 +84,7 @@ public HierarchicalStreamReader createReader(final InputStream in) {\n     @Override\n     public HierarchicalStreamReader createReader(final URL in) {\n         try {\n-            final SAXBuilder builder = new SAXBuilder();\n+            final SAXBuilder builder = createBuilder();\n             final Document document = builder.build(in);\n             return new JDomReader(document, getNameCoder());\n         } catch (final IOException e) {\n@@ -97,7 +97,7 @@ public HierarchicalStreamReader createReader(final URL in) {\n     @Override\n     public HierarchicalStreamReader createReader(final File in) {\n         try {\n-            final SAXBuilder builder = new SAXBuilder();\n+            final SAXBuilder builder = createBuilder();\n             final Document document = builder.build(in);\n             return new JDomReader(document, getNameCoder());\n         } catch (final IOException e) {\n@@ -117,4 +117,16 @@ public HierarchicalStreamWriter createWriter(final OutputStream out) {\n         return new PrettyPrintWriter(new OutputStreamWriter(out));\n     }\n \n+    /**\n+     * Create and initialize the SAX builder.\n+     * \n+     * @return the SAX builder instance.\n+     * @since upcoming\n+     */\n+    protected SAXBuilder createBuilder() {\n+        final SAXBuilder builder = new SAXBuilder();\n+        builder.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n+        return builder;\n+    }\n+\n }"
        },
        {
            "sha": "1ad7812b524da0ac1a6700206686eef4a390c7e6",
            "filename": "xstream/src/test/com/thoughtworks/xstream/io/xml/JDom2ReaderTest.java",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/x-stream/xstream/blob/87172cfc1dd7f8f6e137963c778b03efd14ac446/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FJDom2ReaderTest.java",
            "raw_url": "https://github.com/x-stream/xstream/raw/87172cfc1dd7f8f6e137963c778b03efd14ac446/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FJDom2ReaderTest.java",
            "contents_url": "https://api.github.com/repos/x-stream/xstream/contents/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FJDom2ReaderTest.java?ref=87172cfc1dd7f8f6e137963c778b03efd14ac446",
            "patch": "@@ -15,7 +15,6 @@\n \n import org.jdom2.Document;\n import org.jdom2.Element;\n-import org.jdom2.input.JDOMParseException;\n import org.jdom2.input.SAXBuilder;\n \n import java.io.StringReader;\n@@ -49,10 +48,10 @@ public void testCanReadFromElementOfLargerDocument() throws Exception {\n     public void testIsXXEVulnerable() throws Exception {\n         try {\n             super.testIsXXEVulnerable();\n-            fail(\"Thrown \" + JDOMParseException.class.getName() + \" expected\");\n-        } catch (final JDOMParseException e) {\n+            fail(\"Thrown \" + XStreamException.class.getName() + \" expected\");\n+        } catch (final XStreamException e) {\n             final String message = e.getMessage();\n-            if (message.contains(\"Package\")) {\n+            if (!message.contains(\"DOCTYPE\")) {\n                 throw e;\n             }\n         }"
        },
        {
            "sha": "c8e4cff97cf7571ae403998165676497c1e695b6",
            "filename": "xstream/src/test/com/thoughtworks/xstream/io/xml/JDomReaderTest.java",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/x-stream/xstream/blob/87172cfc1dd7f8f6e137963c778b03efd14ac446/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FJDomReaderTest.java",
            "raw_url": "https://github.com/x-stream/xstream/raw/87172cfc1dd7f8f6e137963c778b03efd14ac446/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FJDomReaderTest.java",
            "contents_url": "https://api.github.com/repos/x-stream/xstream/contents/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FJDomReaderTest.java?ref=87172cfc1dd7f8f6e137963c778b03efd14ac446",
            "patch": "@@ -16,7 +16,6 @@\n \n import org.jdom.Document;\n import org.jdom.Element;\n-import org.jdom.input.JDOMParseException;\n import org.jdom.input.SAXBuilder;\n \n import java.io.StringReader;\n@@ -50,10 +49,10 @@ public void testCanReadFromElementOfLargerDocument() throws Exception {\n     public void testIsXXEVulnerable() throws Exception {\n         try {\n             super.testIsXXEVulnerable();\n-            fail(\"Thrown \" + JDOMParseException.class.getName() + \" expected\");\n-        } catch (final JDOMParseException e) {\n+            fail(\"Thrown \" + XStreamException.class.getName() + \" expected\");\n+        } catch (final XStreamException e) {\n             final String message = e.getMessage();\n-            if (message.contains(\"Package\")) {\n+            if (!message.contains(\"DOCTYPE\")) {\n                 throw e;\n             }\n         }"
        }
    ]
}