{
    "sha": "93866341ec5396d07b5829be55110ff09dc81bcd",
    "node_id": "MDY6Q29tbWl0MTU5Mjg2NTA6OTM4NjYzNDFlYzUzOTZkMDdiNTgyOWJlNTUxMTBmZjA5ZGM4MWJjZA==",
    "commit": {
        "author": {
            "name": "Ren\u00e9 Gielen",
            "email": "rgielen@apache.org",
            "date": "2008-02-25T06:26:12Z"
        },
        "committer": {
            "name": "Ren\u00e9 Gielen",
            "email": "rgielen@apache.org",
            "date": "2008-02-25T06:26:12Z"
        },
        "message": "WW-2427:\nApplied Don Brown's fix for escaping double quote in href to 2.0.x tree\n\ngit-svn-id: https://svn.apache.org/repos/asf/struts/struts2/branches/STRUTS_2_0_X@630742 13f79535-47bb-0310-9956-ffa450edef68",
        "tree": {
            "sha": "b64470e1810c5ef88924663f523e3176ee0fd92e",
            "url": "https://api.github.com/repos/apache/struts/git/trees/b64470e1810c5ef88924663f523e3176ee0fd92e"
        },
        "url": "https://api.github.com/repos/apache/struts/git/commits/93866341ec5396d07b5829be55110ff09dc81bcd",
        "comment_count": 0,
        "verification": {
            "verified": false,
            "reason": "unsigned",
            "signature": null,
            "payload": null,
            "verified_at": null
        }
    },
    "url": "https://api.github.com/repos/apache/struts/commits/93866341ec5396d07b5829be55110ff09dc81bcd",
    "html_url": "https://github.com/apache/struts/commit/93866341ec5396d07b5829be55110ff09dc81bcd",
    "comments_url": "https://api.github.com/repos/apache/struts/commits/93866341ec5396d07b5829be55110ff09dc81bcd/comments",
    "author": {
        "login": "rgielen",
        "id": 64990,
        "node_id": "MDQ6VXNlcjY0OTkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/64990?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rgielen",
        "html_url": "https://github.com/rgielen",
        "followers_url": "https://api.github.com/users/rgielen/followers",
        "following_url": "https://api.github.com/users/rgielen/following{/other_user}",
        "gists_url": "https://api.github.com/users/rgielen/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/rgielen/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rgielen/subscriptions",
        "organizations_url": "https://api.github.com/users/rgielen/orgs",
        "repos_url": "https://api.github.com/users/rgielen/repos",
        "events_url": "https://api.github.com/users/rgielen/events{/privacy}",
        "received_events_url": "https://api.github.com/users/rgielen/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "committer": {
        "login": "rgielen",
        "id": 64990,
        "node_id": "MDQ6VXNlcjY0OTkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/64990?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rgielen",
        "html_url": "https://github.com/rgielen",
        "followers_url": "https://api.github.com/users/rgielen/followers",
        "following_url": "https://api.github.com/users/rgielen/following{/other_user}",
        "gists_url": "https://api.github.com/users/rgielen/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/rgielen/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rgielen/subscriptions",
        "organizations_url": "https://api.github.com/users/rgielen/orgs",
        "repos_url": "https://api.github.com/users/rgielen/repos",
        "events_url": "https://api.github.com/users/rgielen/events{/privacy}",
        "received_events_url": "https://api.github.com/users/rgielen/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "parents": [
        {
            "sha": "dbc620f84ffb626c6e6738afe0578d617a2b3d32",
            "url": "https://api.github.com/repos/apache/struts/commits/dbc620f84ffb626c6e6738afe0578d617a2b3d32",
            "html_url": "https://github.com/apache/struts/commit/dbc620f84ffb626c6e6738afe0578d617a2b3d32"
        }
    ],
    "stats": {
        "total": 34,
        "additions": 33,
        "deletions": 1
    },
    "files": [
        {
            "sha": "ad037697e23562bd05c3a7bf4946a4f5fce707d5",
            "filename": "core/src/main/java/org/apache/struts2/components/AbstractRemoteCallUIBean.java",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/apache/struts/blob/93866341ec5396d07b5829be55110ff09dc81bcd/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fcomponents%2FAbstractRemoteCallUIBean.java",
            "raw_url": "https://github.com/apache/struts/raw/93866341ec5396d07b5829be55110ff09dc81bcd/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fcomponents%2FAbstractRemoteCallUIBean.java",
            "contents_url": "https://api.github.com/repos/apache/struts/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fcomponents%2FAbstractRemoteCallUIBean.java?ref=93866341ec5396d07b5829be55110ff09dc81bcd",
            "patch": "@@ -60,7 +60,7 @@ public void evaluateExtraParams() {\n         super.evaluateExtraParams();\n \n         if (href != null)\n-            addParameter(\"href\", findString(href));\n+             addParameter(\"href\", ensureAttributeSafelyNotEscaped(findString(href)));\n         if (errorText != null)\n             addParameter(\"errorText\", findString(errorText));\n         if (loadingText != null)"
        },
        {
            "sha": "3311cee4d9bad5b3ab94004084994524e2a0ee35",
            "filename": "core/src/main/java/org/apache/struts2/components/UIBean.java",
            "status": "modified",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/apache/struts/blob/93866341ec5396d07b5829be55110ff09dc81bcd/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fcomponents%2FUIBean.java",
            "raw_url": "https://github.com/apache/struts/raw/93866341ec5396d07b5829be55110ff09dc81bcd/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fcomponents%2FUIBean.java",
            "contents_url": "https://api.github.com/repos/apache/struts/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fcomponents%2FUIBean.java?ref=93866341ec5396d07b5829be55110ff09dc81bcd",
            "patch": "@@ -790,6 +790,20 @@ protected String escape(String name) {\n         }\n     }\n \n+    /**\n+     * Ensures an unescaped attribute value cannot be vulnerable to XSS attacks\n+     *\n+     * @param val The value to check\n+     * @return The escaped value\n+     */\n+    protected String ensureAttributeSafelyNotEscaped(String val) {\n+        if (val != null) {\n+            return val.replaceAll(\"\\\"\", \"&#34;\");\n+        } else {\n+            return \"\";\n+        }\n+    }\n+\n     protected void evaluateExtraParams() {\n     }\n "
        },
        {
            "sha": "777c3f31771870a5dfb41791a3b5ff173573b3ba",
            "filename": "core/src/test/java/org/apache/struts2/views/jsp/ui/AnchorTest.java",
            "status": "modified",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/apache/struts/blob/93866341ec5396d07b5829be55110ff09dc81bcd/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fstruts2%2Fviews%2Fjsp%2Fui%2FAnchorTest.java",
            "raw_url": "https://github.com/apache/struts/raw/93866341ec5396d07b5829be55110ff09dc81bcd/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fstruts2%2Fviews%2Fjsp%2Fui%2FAnchorTest.java",
            "contents_url": "https://api.github.com/repos/apache/struts/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fstruts2%2Fviews%2Fjsp%2Fui%2FAnchorTest.java?ref=93866341ec5396d07b5829be55110ff09dc81bcd",
            "patch": "@@ -56,4 +56,18 @@ public void testSimple() throws Exception {\n         verify(AnchorTest.class.getResource(\"href-1.txt\"));\n     }\n \n+    public void testSimpleBadQuote() throws Exception {\n+        TestAction testAction = (TestAction) action;\n+        testAction.setFoo(\"bar\");\n+\n+        AnchorTag tag = new AnchorTag();\n+        tag.setPageContext(pageContext);\n+\n+        tag.setId(\"mylink\");\n+        tag.setHref(\"a\\\"\");\n+        tag.doStartTag();\n+        tag.doEndTag();\n+\n+        verify(AnchorTest.class.getResource(\"href-2.txt\"));\n+    }\n }"
        },
        {
            "sha": "ec8b7ad36e12a29191525928544e49500f01a9e6",
            "filename": "core/src/test/resources/org/apache/struts2/views/jsp/ui/href-2.txt",
            "status": "added",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/apache/struts/blob/93866341ec5396d07b5829be55110ff09dc81bcd/core%2Fsrc%2Ftest%2Fresources%2Forg%2Fapache%2Fstruts2%2Fviews%2Fjsp%2Fui%2Fhref-2.txt",
            "raw_url": "https://github.com/apache/struts/raw/93866341ec5396d07b5829be55110ff09dc81bcd/core%2Fsrc%2Ftest%2Fresources%2Forg%2Fapache%2Fstruts2%2Fviews%2Fjsp%2Fui%2Fhref-2.txt",
            "contents_url": "https://api.github.com/repos/apache/struts/contents/core%2Fsrc%2Ftest%2Fresources%2Forg%2Fapache%2Fstruts2%2Fviews%2Fjsp%2Fui%2Fhref-2.txt?ref=93866341ec5396d07b5829be55110ff09dc81bcd",
            "patch": "@@ -0,0 +1,4 @@\n+<a\n+ id=\"mylink\"\n+ href=\"a&#34;\">\n+</a>\n\\ No newline at end of file"
        }
    ]
}