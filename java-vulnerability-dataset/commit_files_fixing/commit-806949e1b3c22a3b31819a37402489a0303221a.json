{
    "sha": "806949e1b3c22a3b31819a37402489a0303221a1",
    "node_id": "MDY6Q29tbWl0MzIyMTk2MjQ6ODA2OTQ5ZTFiM2MyMmEzYjMxODE5YTM3NDAyNDg5YTAzMDMyMjFhMQ==",
    "commit": {
        "author": {
            "name": "joehni",
            "email": "joerg.schaible@gmx.de",
            "date": "2015-10-09T07:24:06Z"
        },
        "committer": {
            "name": "joehni",
            "email": "joerg.schaible@gmx.de",
            "date": "2015-10-09T07:24:06Z"
        },
        "message": "Adapt driver behavior for XXE vulnerability on Java 5.",
        "tree": {
            "sha": "a1c599e06604868133477b106c582a76b71dad88",
            "url": "https://api.github.com/repos/x-stream/xstream/git/trees/a1c599e06604868133477b106c582a76b71dad88"
        },
        "url": "https://api.github.com/repos/x-stream/xstream/git/commits/806949e1b3c22a3b31819a37402489a0303221a1",
        "comment_count": 0,
        "verification": {
            "verified": false,
            "reason": "unsigned",
            "signature": null,
            "payload": null,
            "verified_at": null
        }
    },
    "url": "https://api.github.com/repos/x-stream/xstream/commits/806949e1b3c22a3b31819a37402489a0303221a1",
    "html_url": "https://github.com/x-stream/xstream/commit/806949e1b3c22a3b31819a37402489a0303221a1",
    "comments_url": "https://api.github.com/repos/x-stream/xstream/commits/806949e1b3c22a3b31819a37402489a0303221a1/comments",
    "author": {
        "login": "joehni",
        "id": 795149,
        "node_id": "MDQ6VXNlcjc5NTE0OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/795149?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/joehni",
        "html_url": "https://github.com/joehni",
        "followers_url": "https://api.github.com/users/joehni/followers",
        "following_url": "https://api.github.com/users/joehni/following{/other_user}",
        "gists_url": "https://api.github.com/users/joehni/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/joehni/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/joehni/subscriptions",
        "organizations_url": "https://api.github.com/users/joehni/orgs",
        "repos_url": "https://api.github.com/users/joehni/repos",
        "events_url": "https://api.github.com/users/joehni/events{/privacy}",
        "received_events_url": "https://api.github.com/users/joehni/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "committer": {
        "login": "joehni",
        "id": 795149,
        "node_id": "MDQ6VXNlcjc5NTE0OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/795149?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/joehni",
        "html_url": "https://github.com/joehni",
        "followers_url": "https://api.github.com/users/joehni/followers",
        "following_url": "https://api.github.com/users/joehni/following{/other_user}",
        "gists_url": "https://api.github.com/users/joehni/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/joehni/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/joehni/subscriptions",
        "organizations_url": "https://api.github.com/users/joehni/orgs",
        "repos_url": "https://api.github.com/users/joehni/repos",
        "events_url": "https://api.github.com/users/joehni/events{/privacy}",
        "received_events_url": "https://api.github.com/users/joehni/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "parents": [
        {
            "sha": "24c07d04b3da50be90330a2c35ba9a80fdd345a3",
            "url": "https://api.github.com/repos/x-stream/xstream/commits/24c07d04b3da50be90330a2c35ba9a80fdd345a3",
            "html_url": "https://github.com/x-stream/xstream/commit/24c07d04b3da50be90330a2c35ba9a80fdd345a3"
        }
    ],
    "stats": {
        "total": 30,
        "additions": 22,
        "deletions": 8
    },
    "files": [
        {
            "sha": "3545ea735734757baad6171ed0744ec5b5c28601",
            "filename": "xstream-distribution/src/content/faq.html",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/x-stream/xstream/blob/806949e1b3c22a3b31819a37402489a0303221a1/xstream-distribution%2Fsrc%2Fcontent%2Ffaq.html",
            "raw_url": "https://github.com/x-stream/xstream/raw/806949e1b3c22a3b31819a37402489a0303221a1/xstream-distribution%2Fsrc%2Fcontent%2Ffaq.html",
            "contents_url": "https://api.github.com/repos/x-stream/xstream/contents/xstream-distribution%2Fsrc%2Fcontent%2Ffaq.html?ref=806949e1b3c22a3b31819a37402489a0303221a1",
            "patch": "@@ -722,8 +722,9 @@ <h2 id=\"Security_XXEVulnerability\">Is XStream XXE vulnerable?</h2>\n     \tfor parameter entities.</td></tr>\n     \t<tr><td>Dom4JDriver</td><td>no</td><td>Driver turns off DOCTYPE processing to suppress handling of external\n     \tentities with SAX reader in use.</td></tr>\n-    \t<tr><td>DomDriver</td><td>no</td><td>Driver turns off DOCTYPE processing to suppress handling of external\n-    \tentities with SAX reader in use.</td></tr>\n+    \t<tr><td>DomDriver</td><td>no, Java 6 or higher<br/>yes, Java 5</td><td>Driver turns off DOCTYPE processing with\n+    \tJava 7 runtime or higher to suppress handling of external entities with SAX reader in use. Suppress external\n+    \tentities only for Java 6 or lower, fails for parameterized entities.</td></tr>\n     \t<tr><td>JDomDriver</td><td>no</td><td>Driver turns off DOCTYPE processing to suppress handling of external\n     \tentities with SAX reader in use.</td></tr>\n     \t<tr><td>JDom2Driver</td><td>no</td><td>Driver turns off DOCTYPE processing to suppress handling of external"
        },
        {
            "sha": "9aebb758e8d5dd35e2c9940f0549443bd7aba140",
            "filename": "xstream/src/java/com/thoughtworks/xstream/io/xml/DomDriver.java",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/x-stream/xstream/blob/806949e1b3c22a3b31819a37402489a0303221a1/xstream%2Fsrc%2Fjava%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FDomDriver.java",
            "raw_url": "https://github.com/x-stream/xstream/raw/806949e1b3c22a3b31819a37402489a0303221a1/xstream%2Fsrc%2Fjava%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FDomDriver.java",
            "contents_url": "https://api.github.com/repos/x-stream/xstream/contents/xstream%2Fsrc%2Fjava%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FDomDriver.java?ref=806949e1b3c22a3b31819a37402489a0303221a1",
            "patch": "@@ -150,7 +150,12 @@ protected DocumentBuilderFactory createDocumentBuilderFactory() {\n             } catch (IllegalAccessException e) {\n                 throw new ObjectAccessException(\"Cannot set feature of DocumentBuilderFactory.\", e);\n             } catch (InvocationTargetException e) {\n-                throw new StreamException(e.getCause());\n+                Throwable cause = e.getCause();\n+                if (JVM.is16() \n+                        || (cause instanceof ParserConfigurationException \n+                                &&  cause.getMessage().indexOf(\"disallow-doctype-decl\") < 0)) { \n+                    throw new StreamException(cause);\n+                }\n             }\n         }\n         factory.setExpandEntityReferences(false);"
        },
        {
            "sha": "441a9ae938250c0ae36bcce73ab9b5041bb28a6e",
            "filename": "xstream/src/test/com/thoughtworks/xstream/io/xml/DomReaderTest.java",
            "status": "modified",
            "additions": 9,
            "deletions": 4,
            "changes": 13,
            "blob_url": "https://github.com/x-stream/xstream/blob/806949e1b3c22a3b31819a37402489a0303221a1/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FDomReaderTest.java",
            "raw_url": "https://github.com/x-stream/xstream/raw/806949e1b3c22a3b31819a37402489a0303221a1/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FDomReaderTest.java",
            "contents_url": "https://api.github.com/repos/x-stream/xstream/contents/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FDomReaderTest.java?ref=806949e1b3c22a3b31819a37402489a0303221a1",
            "patch": "@@ -88,7 +88,7 @@ public void testExposesAttributesKeysAndValuesByIndex() throws Exception {\n     public void testIsXXEVulnerableWithExternalGeneralEntity() throws Exception {\n         try {\n             super.testIsXXEVulnerableWithExternalGeneralEntity();\n-            if (JVM.is15()) {\n+            if (JVM.is16()) {\n                 fail(\"Thrown \" + XStreamException.class.getName() + \" expected\");\n             }\n         } catch (final XStreamException e) {\n@@ -98,7 +98,7 @@ public void testIsXXEVulnerableWithExternalGeneralEntity() throws Exception {\n             }\n         } catch (final NullPointerException e) {\n             // NPE only with Sun Java 1.6 runtime\n-            if (JVM.is17()) {\n+            if (JVM.is17() || !JVM.is16()) {\n                 throw e;\n             }\n         }\n@@ -111,11 +111,16 @@ public void testIsXXEVulnerableWithExternalParameterEntity() throws Exception {\n         } catch (final XStreamException e) {\n             final String message = e.getMessage();\n             if (message.indexOf(\"DOCTYPE\") < 0) {\n-                throw e;\n+                // XXE vulnerable with Sun Java 1.6 runtime\n+                if (JVM.is16() || !JVM.is15()) {\n+                    throw e;\n+                } else {\n+                    System.err.println(\"DomReader is vulnerable with Java 5!\");\n+                }\n             }\n         } catch (final NullPointerException e) {\n             // NPE only with Sun Java 1.6 runtime\n-            if (JVM.is17()) {\n+            if (JVM.is17() || !JVM.is16()) {\n                 throw e;\n             }\n         }"
        },
        {
            "sha": "d26f2050e294b01d563e6e79ad2a6dfd6c7eadce",
            "filename": "xstream/src/test/com/thoughtworks/xstream/io/xml/StaxReaderTest.java",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/x-stream/xstream/blob/806949e1b3c22a3b31819a37402489a0303221a1/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FStaxReaderTest.java",
            "raw_url": "https://github.com/x-stream/xstream/raw/806949e1b3c22a3b31819a37402489a0303221a1/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FStaxReaderTest.java",
            "contents_url": "https://api.github.com/repos/x-stream/xstream/contents/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FStaxReaderTest.java?ref=806949e1b3c22a3b31819a37402489a0303221a1",
            "patch": "@@ -14,6 +14,7 @@\n import java.io.StringReader;\n \n import com.thoughtworks.xstream.XStreamException;\n+import com.thoughtworks.xstream.core.JVM;\n import com.thoughtworks.xstream.io.HierarchicalStreamReader;\n \n \n@@ -41,7 +42,9 @@ public void testIsXXEVulnerableWithExternalParameterEntity() throws Exception {\n         } catch (final XStreamException e) {\n             final String message = e.getMessage();\n             if (message.indexOf(\"external entity\") < 0) {\n-                if (message.indexOf(\"com.wutka.dtd.DTDParseException\") >= 0) {\n+                if (JVM.is16() && message.indexOf(\"com.wutka.dtd.DTDParseException\") >= 0) {\n+                    System.err.println(\"BEAStaxReader was selected as default StAX driver for StaxReaderTest!\");\n+                } else if (JVM.is15() && message.replaceAll(\"[:space:]\", \"\").endsWith(\"null\")) {\n                     System.err.println(\"BEAStaxReader was selected as default StAX driver for StaxReaderTest!\");\n                 } else {\n                     throw e;"
        }
    ]
}