{
    "sha": "2412c90ba5584fed123fa6a33e752e6c8eaf74e9",
    "node_id": "MDY6Q29tbWl0MTA2Mzc4OTI6MjQxMmM5MGJhNTU4NGZlZDEyM2ZhNmEzM2U3NTJlNmM4ZWFmNzRlOQ==",
    "commit": {
        "author": {
            "name": "Oliver Heger",
            "email": "oheger@apache.org",
            "date": "2014-05-24T20:11:58Z"
        },
        "committer": {
            "name": "Oliver Heger",
            "email": "oheger@apache.org",
            "date": "2014-05-24T20:11:58Z"
        },
        "message": "[BEANUTILS-463] Added an easy way to suppress the class property.\n\nA specialized instance suppressing the class property common to all Java\nobjects has been added as constant to SuppressPropertiesBeanIntrospector. A\ntest case was created demonstrating that the property can no longer be accessed\nwith this introspector being active.\n\ngit-svn-id: https://svn.apache.org/repos/asf/commons/proper/beanutils/trunk@1597344 13f79535-47bb-0310-9956-ffa450edef68",
        "tree": {
            "sha": "d307a2d2b40a7bb5d77584f2ddf65c191a348598",
            "url": "https://api.github.com/repos/apache/commons-beanutils/git/trees/d307a2d2b40a7bb5d77584f2ddf65c191a348598"
        },
        "url": "https://api.github.com/repos/apache/commons-beanutils/git/commits/2412c90ba5584fed123fa6a33e752e6c8eaf74e9",
        "comment_count": 0,
        "verification": {
            "verified": false,
            "reason": "unsigned",
            "signature": null,
            "payload": null,
            "verified_at": null
        }
    },
    "url": "https://api.github.com/repos/apache/commons-beanutils/commits/2412c90ba5584fed123fa6a33e752e6c8eaf74e9",
    "html_url": "https://github.com/apache/commons-beanutils/commit/2412c90ba5584fed123fa6a33e752e6c8eaf74e9",
    "comments_url": "https://api.github.com/repos/apache/commons-beanutils/commits/2412c90ba5584fed123fa6a33e752e6c8eaf74e9/comments",
    "author": null,
    "committer": null,
    "parents": [
        {
            "sha": "4e410e068b8d367c53766a7da712b1b6f3fd8101",
            "url": "https://api.github.com/repos/apache/commons-beanutils/commits/4e410e068b8d367c53766a7da712b1b6f3fd8101",
            "html_url": "https://github.com/apache/commons-beanutils/commit/4e410e068b8d367c53766a7da712b1b6f3fd8101"
        }
    ],
    "stats": {
        "total": 59,
        "additions": 59,
        "deletions": 0
    },
    "files": [
        {
            "sha": "9d4e3b3069894ba77c6c492e4742037d9c2a223e",
            "filename": "src/main/java/org/apache/commons/beanutils/SuppressPropertiesBeanIntrospector.java",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/apache/commons-beanutils/blob/2412c90ba5584fed123fa6a33e752e6c8eaf74e9/src%2Fmain%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2FSuppressPropertiesBeanIntrospector.java",
            "raw_url": "https://github.com/apache/commons-beanutils/raw/2412c90ba5584fed123fa6a33e752e6c8eaf74e9/src%2Fmain%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2FSuppressPropertiesBeanIntrospector.java",
            "contents_url": "https://api.github.com/repos/apache/commons-beanutils/contents/src%2Fmain%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2FSuppressPropertiesBeanIntrospector.java?ref=2412c90ba5584fed123fa6a33e752e6c8eaf74e9",
            "patch": "@@ -21,6 +21,17 @@\n  * @since 1.9.2\n  */\n public class SuppressPropertiesBeanIntrospector implements BeanIntrospector {\n+    /**\n+     * A specialized instance which is configured to suppress the special {@code class}\n+     * properties of Java beans. Unintended access to the property {@code class} (which is\n+     * common to all Java objects) can be a security risk because it also allows access to\n+     * the class loader. Adding this instance as {@code BeanIntrospector} to an instance\n+     * of {@code PropertyUtilsBean} suppresses the {@code class} property; it can then no\n+     * longer be accessed.\n+     */\n+    public static final SuppressPropertiesBeanIntrospector SUPPRESS_CLASS =\n+            new SuppressPropertiesBeanIntrospector(Collections.singleton(\"class\"));\n+\n     /** A set with the names of the properties to be suppressed. */\n     private final Set<String> propertyNames;\n "
        },
        {
            "sha": "31ac31ce037a29167e6818d73539e8053495bc82",
            "filename": "src/test/java/org/apache/commons/beanutils/bugs/Jira463TestCase.java",
            "status": "added",
            "additions": 48,
            "deletions": 0,
            "changes": 48,
            "blob_url": "https://github.com/apache/commons-beanutils/blob/2412c90ba5584fed123fa6a33e752e6c8eaf74e9/src%2Ftest%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2Fbugs%2FJira463TestCase.java",
            "raw_url": "https://github.com/apache/commons-beanutils/raw/2412c90ba5584fed123fa6a33e752e6c8eaf74e9/src%2Ftest%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2Fbugs%2FJira463TestCase.java",
            "contents_url": "https://api.github.com/repos/apache/commons-beanutils/contents/src%2Ftest%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2Fbugs%2FJira463TestCase.java?ref=2412c90ba5584fed123fa6a33e752e6c8eaf74e9",
            "patch": "@@ -0,0 +1,48 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.commons.beanutils.bugs;\n+\n+import junit.framework.TestCase;\n+\n+import org.apache.commons.beanutils.AlphaBean;\n+import org.apache.commons.beanutils.BeanUtilsBean;\n+import org.apache.commons.beanutils.SuppressPropertiesBeanIntrospector;\n+\n+/**\n+ * Class loader vulnerability in DefaultResolver\n+ *\n+ * @version $Id$\n+ * @see <a href=\"https://issues.apache.org/jira/browse/BEANUTILS-463\">https://issues.apache.org/jira/browse/BEANUTILS-463</a>\n+ */\n+public class Jira463TestCase extends TestCase {\n+    /**\n+     * Tests that with a specialized {@code BeanIntrospector} implementation the class\n+     * property can be suppressed.\n+     */\n+    public void testSuppressClassProperty() throws Exception {\n+        BeanUtilsBean bub = new BeanUtilsBean();\n+        bub.getPropertyUtils().addBeanIntrospector(\n+                SuppressPropertiesBeanIntrospector.SUPPRESS_CLASS);\n+        AlphaBean bean = new AlphaBean();\n+        try {\n+            bub.getProperty(bean, \"class\");\n+            fail(\"Could access class property!\");\n+        } catch (NoSuchMethodException ex) {\n+            // ok\n+        }\n+    }\n+}"
        }
    ]
}