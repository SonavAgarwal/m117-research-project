{
    "sha": "dbc620f84ffb626c6e6738afe0578d617a2b3d32",
    "node_id": "MDY6Q29tbWl0MTU5Mjg2NTA6ZGJjNjIwZjg0ZmZiNjI2YzZlNjczOGFmZTA1NzhkNjE3YTJiM2QzMg==",
    "commit": {
        "author": {
            "name": "Ren\u00e9 Gielen",
            "email": "rgielen@apache.org",
            "date": "2008-02-25T06:09:14Z"
        },
        "committer": {
            "name": "Ren\u00e9 Gielen",
            "email": "rgielen@apache.org",
            "date": "2008-02-25T06:09:14Z"
        },
        "message": "WW-2414:\nApplied James Mitchell's patch for critical XSS bug to 2.0.x tree\n\ngit-svn-id: https://svn.apache.org/repos/asf/struts/struts2/branches/STRUTS_2_0_X@630740 13f79535-47bb-0310-9956-ffa450edef68",
        "tree": {
            "sha": "84b616b929c8f653f187b556e1cd6d5240ffbb1c",
            "url": "https://api.github.com/repos/apache/struts/git/trees/84b616b929c8f653f187b556e1cd6d5240ffbb1c"
        },
        "url": "https://api.github.com/repos/apache/struts/git/commits/dbc620f84ffb626c6e6738afe0578d617a2b3d32",
        "comment_count": 0,
        "verification": {
            "verified": false,
            "reason": "unsigned",
            "signature": null,
            "payload": null,
            "verified_at": null
        }
    },
    "url": "https://api.github.com/repos/apache/struts/commits/dbc620f84ffb626c6e6738afe0578d617a2b3d32",
    "html_url": "https://github.com/apache/struts/commit/dbc620f84ffb626c6e6738afe0578d617a2b3d32",
    "comments_url": "https://api.github.com/repos/apache/struts/commits/dbc620f84ffb626c6e6738afe0578d617a2b3d32/comments",
    "author": {
        "login": "rgielen",
        "id": 64990,
        "node_id": "MDQ6VXNlcjY0OTkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/64990?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rgielen",
        "html_url": "https://github.com/rgielen",
        "followers_url": "https://api.github.com/users/rgielen/followers",
        "following_url": "https://api.github.com/users/rgielen/following{/other_user}",
        "gists_url": "https://api.github.com/users/rgielen/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/rgielen/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rgielen/subscriptions",
        "organizations_url": "https://api.github.com/users/rgielen/orgs",
        "repos_url": "https://api.github.com/users/rgielen/repos",
        "events_url": "https://api.github.com/users/rgielen/events{/privacy}",
        "received_events_url": "https://api.github.com/users/rgielen/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "committer": {
        "login": "rgielen",
        "id": 64990,
        "node_id": "MDQ6VXNlcjY0OTkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/64990?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rgielen",
        "html_url": "https://github.com/rgielen",
        "followers_url": "https://api.github.com/users/rgielen/followers",
        "following_url": "https://api.github.com/users/rgielen/following{/other_user}",
        "gists_url": "https://api.github.com/users/rgielen/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/rgielen/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rgielen/subscriptions",
        "organizations_url": "https://api.github.com/users/rgielen/orgs",
        "repos_url": "https://api.github.com/users/rgielen/repos",
        "events_url": "https://api.github.com/users/rgielen/events{/privacy}",
        "received_events_url": "https://api.github.com/users/rgielen/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "parents": [
        {
            "sha": "f88805221f9fcdcaf3c2d95e0ec3ef673fab7fcd",
            "url": "https://api.github.com/repos/apache/struts/commits/f88805221f9fcdcaf3c2d95e0ec3ef673fab7fcd",
            "html_url": "https://github.com/apache/struts/commit/f88805221f9fcdcaf3c2d95e0ec3ef673fab7fcd"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
    },
    "files": [
        {
            "sha": "446db6908df252b230f862d41ec6a97f9f9a2a4f",
            "filename": "core/src/main/java/org/apache/struts2/views/util/UrlHelper.java",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/apache/struts/blob/dbc620f84ffb626c6e6738afe0578d617a2b3d32/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fviews%2Futil%2FUrlHelper.java",
            "raw_url": "https://github.com/apache/struts/raw/dbc620f84ffb626c6e6738afe0578d617a2b3d32/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fviews%2Futil%2FUrlHelper.java",
            "contents_url": "https://api.github.com/repos/apache/struts/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fviews%2Futil%2FUrlHelper.java?ref=dbc620f84ffb626c6e6738afe0578d617a2b3d32",
            "patch": "@@ -188,10 +188,14 @@ else if ((scheme != null) && !scheme.equals(request.getScheme())) {\n             buildParametersString(params, link, \"&\");\n         }\n \n-        String result;\n+        String result = link.toString();\n+\n+        while (result.indexOf(\"<script>\") > 0) {\n+            result = result.replaceAll(\"<script>\", \"script\");\n+        }\n \n         try {\n-            result = encodeResult ? response.encodeURL(link.toString()) : link.toString();\n+             result = encodeResult ? response.encodeURL(result) : result;\n         } catch (Exception ex) {\n             // Could not encode the URL for some reason\n             // Use it unchanged"
        }
    ]
}