{
    "sha": "dac97f1b7dac3e70ff603fb6fc9f205b95dd6b01",
    "node_id": "MDY6Q29tbWl0MTE0ODc1MzpkYWM5N2YxYjdkYWMzZTcwZmY2MDNmYjZmYzlmMjA1Yjk1ZGQ2YjAx",
    "commit": {
        "author": {
            "name": "Brian Clozel",
            "email": "bclozel@pivotal.io",
            "date": "2018-05-18T12:35:35Z"
        },
        "committer": {
            "name": "Brian Clozel",
            "email": "bclozel@pivotal.io",
            "date": "2018-06-11T17:17:00Z"
        },
        "message": "Restrict HTTP methods on Reactive HiddenHttpMethodFilter\n\nThis commit restricts the allowed HTTP methods on HiddenHttpMethodFilter\n(Reactive variant) to the following: PUT, DELETE, PATCH.\n\nThis filter is meant to be used to simulate those methods from HTML\nforms sent by browsers, so no other methods are allowed.\n\nIssue: SPR-16836\n(Cherry-picked from a5cd01a4c8)",
        "tree": {
            "sha": "52afe307aac1e22aca6927847ea15f6a66fd0d64",
            "url": "https://api.github.com/repos/spring-projects/spring-framework/git/trees/52afe307aac1e22aca6927847ea15f6a66fd0d64"
        },
        "url": "https://api.github.com/repos/spring-projects/spring-framework/git/commits/dac97f1b7dac3e70ff603fb6fc9f205b95dd6b01",
        "comment_count": 0,
        "verification": {
            "verified": false,
            "reason": "unsigned",
            "signature": null,
            "payload": null,
            "verified_at": null
        }
    },
    "url": "https://api.github.com/repos/spring-projects/spring-framework/commits/dac97f1b7dac3e70ff603fb6fc9f205b95dd6b01",
    "html_url": "https://github.com/spring-projects/spring-framework/commit/dac97f1b7dac3e70ff603fb6fc9f205b95dd6b01",
    "comments_url": "https://api.github.com/repos/spring-projects/spring-framework/commits/dac97f1b7dac3e70ff603fb6fc9f205b95dd6b01/comments",
    "author": {
        "login": "bclozel",
        "id": 103264,
        "node_id": "MDQ6VXNlcjEwMzI2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/103264?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bclozel",
        "html_url": "https://github.com/bclozel",
        "followers_url": "https://api.github.com/users/bclozel/followers",
        "following_url": "https://api.github.com/users/bclozel/following{/other_user}",
        "gists_url": "https://api.github.com/users/bclozel/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bclozel/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bclozel/subscriptions",
        "organizations_url": "https://api.github.com/users/bclozel/orgs",
        "repos_url": "https://api.github.com/users/bclozel/repos",
        "events_url": "https://api.github.com/users/bclozel/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bclozel/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "committer": {
        "login": "bclozel",
        "id": 103264,
        "node_id": "MDQ6VXNlcjEwMzI2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/103264?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bclozel",
        "html_url": "https://github.com/bclozel",
        "followers_url": "https://api.github.com/users/bclozel/followers",
        "following_url": "https://api.github.com/users/bclozel/following{/other_user}",
        "gists_url": "https://api.github.com/users/bclozel/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bclozel/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bclozel/subscriptions",
        "organizations_url": "https://api.github.com/users/bclozel/orgs",
        "repos_url": "https://api.github.com/users/bclozel/repos",
        "events_url": "https://api.github.com/users/bclozel/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bclozel/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "parents": [
        {
            "sha": "f2694a8ed93f1f63f87ce45d0bb638478b426acd",
            "url": "https://api.github.com/repos/spring-projects/spring-framework/commits/f2694a8ed93f1f63f87ce45d0bb638478b426acd",
            "html_url": "https://github.com/spring-projects/spring-framework/commit/f2694a8ed93f1f63f87ce45d0bb638478b426acd"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 21,
        "deletions": 3
    },
    "files": [
        {
            "sha": "72723aa4e16fe6bf996d4b04bf9b795372e688f0",
            "filename": "spring-web/src/main/java/org/springframework/web/filter/reactive/HiddenHttpMethodFilter.java",
            "status": "modified",
            "additions": 14,
            "deletions": 2,
            "changes": 16,
            "blob_url": "https://github.com/spring-projects/spring-framework/blob/dac97f1b7dac3e70ff603fb6fc9f205b95dd6b01/spring-web%2Fsrc%2Fmain%2Fjava%2Forg%2Fspringframework%2Fweb%2Ffilter%2Freactive%2FHiddenHttpMethodFilter.java",
            "raw_url": "https://github.com/spring-projects/spring-framework/raw/dac97f1b7dac3e70ff603fb6fc9f205b95dd6b01/spring-web%2Fsrc%2Fmain%2Fjava%2Forg%2Fspringframework%2Fweb%2Ffilter%2Freactive%2FHiddenHttpMethodFilter.java",
            "contents_url": "https://api.github.com/repos/spring-projects/spring-framework/contents/spring-web%2Fsrc%2Fmain%2Fjava%2Forg%2Fspringframework%2Fweb%2Ffilter%2Freactive%2FHiddenHttpMethodFilter.java?ref=dac97f1b7dac3e70ff603fb6fc9f205b95dd6b01",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 2002-2017 the original author or authors.\n+ * Copyright 2002-2018 the original author or authors.\n  *\n  * Licensed under the Apache License, Version 2.0 (the \"License\");\n  * you may not use this file except in compliance with the License.\n@@ -16,6 +16,9 @@\n \n package org.springframework.web.filter.reactive;\n \n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.List;\n import java.util.Locale;\n \n import reactor.core.publisher.Mono;\n@@ -45,6 +48,10 @@\n  */\n public class HiddenHttpMethodFilter implements WebFilter {\n \n+\tprivate static final List<HttpMethod> ALLOWED_METHODS =\n+\t\t\tCollections.unmodifiableList(Arrays.asList(HttpMethod.PUT,\n+\t\t\t\t\tHttpMethod.DELETE, HttpMethod.PATCH));\n+\n \t/** Default name of the form parameter with the HTTP method to use */\n \tpublic static final String DEFAULT_METHOD_PARAMETER_NAME = \"_method\";\n \n@@ -87,7 +94,12 @@ public Mono<Void> filter(ServerWebExchange exchange, WebFilterChain chain) {\n \tprivate ServerWebExchange mapExchange(ServerWebExchange exchange, String methodParamValue) {\n \t\tHttpMethod httpMethod = HttpMethod.resolve(methodParamValue.toUpperCase(Locale.ENGLISH));\n \t\tAssert.notNull(httpMethod, () -> \"HttpMethod '\" + methodParamValue + \"' not supported\");\n-\t\treturn exchange.mutate().request(builder -> builder.method(httpMethod)).build();\n+\t\tif (ALLOWED_METHODS.contains(httpMethod)) {\n+\t\t\treturn exchange.mutate().request(builder -> builder.method(httpMethod)).build();\n+\t\t}\n+\t\telse {\n+\t\t\treturn exchange;\n+\t\t}\n \t}\n \n }"
        },
        {
            "sha": "f962728da4cf12b0441ef968c25b1c9a769452db",
            "filename": "spring-web/src/test/java/org/springframework/web/filter/reactive/HiddenHttpMethodFilterTests.java",
            "status": "modified",
            "additions": 7,
            "deletions": 1,
            "changes": 8,
            "blob_url": "https://github.com/spring-projects/spring-framework/blob/dac97f1b7dac3e70ff603fb6fc9f205b95dd6b01/spring-web%2Fsrc%2Ftest%2Fjava%2Forg%2Fspringframework%2Fweb%2Ffilter%2Freactive%2FHiddenHttpMethodFilterTests.java",
            "raw_url": "https://github.com/spring-projects/spring-framework/raw/dac97f1b7dac3e70ff603fb6fc9f205b95dd6b01/spring-web%2Fsrc%2Ftest%2Fjava%2Forg%2Fspringframework%2Fweb%2Ffilter%2Freactive%2FHiddenHttpMethodFilterTests.java",
            "contents_url": "https://api.github.com/repos/spring-projects/spring-framework/contents/spring-web%2Fsrc%2Ftest%2Fjava%2Forg%2Fspringframework%2Fweb%2Ffilter%2Freactive%2FHiddenHttpMethodFilterTests.java?ref=dac97f1b7dac3e70ff603fb6fc9f205b95dd6b01",
            "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 2002-2017 the original author or authors.\n+ * Copyright 2002-2018 the original author or authors.\n  *\n  * Licensed under the Apache License, Version 2.0 (the \"License\");\n  * you may not use this file except in compliance with the License.\n@@ -52,6 +52,12 @@ public void filterWithParameter() {\n \t\tassertEquals(HttpMethod.DELETE, this.filterChain.getHttpMethod());\n \t}\n \n+\t@Test\n+\tpublic void filterWithParameterMethodNotAllowed() {\n+\t\tpostForm(\"_method=TRACE\").block(Duration.ZERO);\n+\t\tassertEquals(HttpMethod.POST, this.filterChain.getHttpMethod());\n+\t}\n+\n \t@Test\n \tpublic void filterWithNoParameter() {\n \t\tpostForm(\"\").block(Duration.ZERO);"
        }
    ]
}