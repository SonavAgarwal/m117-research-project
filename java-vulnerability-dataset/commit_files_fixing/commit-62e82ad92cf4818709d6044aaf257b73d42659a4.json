{
    "sha": "62e82ad92cf4818709d6044aaf257b73d42659a4",
    "node_id": "MDY6Q29tbWl0MTA2Mzc4OTI6NjJlODJhZDkyY2Y0ODE4NzA5ZDYwNDRhYWYyNTdiNzNkNDI2NTlhNA==",
    "commit": {
        "author": {
            "name": "Rob Tompkins",
            "email": "chtompki@gmail.com",
            "date": "2019-06-06T00:38:37Z"
        },
        "committer": {
            "name": "Rob Tompkins",
            "email": "chtompki@gmail.com",
            "date": "2019-06-06T00:38:37Z"
        },
        "message": "BEANUTILS-520: mitigation for CVE-2014-0114",
        "tree": {
            "sha": "acb60caa2e2e5ddb5ef71495764b60100dbe164e",
            "url": "https://api.github.com/repos/apache/commons-beanutils/git/trees/acb60caa2e2e5ddb5ef71495764b60100dbe164e"
        },
        "url": "https://api.github.com/repos/apache/commons-beanutils/git/commits/62e82ad92cf4818709d6044aaf257b73d42659a4",
        "comment_count": 0,
        "verification": {
            "verified": false,
            "reason": "unsigned",
            "signature": null,
            "payload": null,
            "verified_at": null
        }
    },
    "url": "https://api.github.com/repos/apache/commons-beanutils/commits/62e82ad92cf4818709d6044aaf257b73d42659a4",
    "html_url": "https://github.com/apache/commons-beanutils/commit/62e82ad92cf4818709d6044aaf257b73d42659a4",
    "comments_url": "https://api.github.com/repos/apache/commons-beanutils/commits/62e82ad92cf4818709d6044aaf257b73d42659a4/comments",
    "author": {
        "login": "chtompki",
        "id": 1291539,
        "node_id": "MDQ6VXNlcjEyOTE1Mzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1291539?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/chtompki",
        "html_url": "https://github.com/chtompki",
        "followers_url": "https://api.github.com/users/chtompki/followers",
        "following_url": "https://api.github.com/users/chtompki/following{/other_user}",
        "gists_url": "https://api.github.com/users/chtompki/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/chtompki/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/chtompki/subscriptions",
        "organizations_url": "https://api.github.com/users/chtompki/orgs",
        "repos_url": "https://api.github.com/users/chtompki/repos",
        "events_url": "https://api.github.com/users/chtompki/events{/privacy}",
        "received_events_url": "https://api.github.com/users/chtompki/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "committer": {
        "login": "chtompki",
        "id": 1291539,
        "node_id": "MDQ6VXNlcjEyOTE1Mzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1291539?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/chtompki",
        "html_url": "https://github.com/chtompki",
        "followers_url": "https://api.github.com/users/chtompki/followers",
        "following_url": "https://api.github.com/users/chtompki/following{/other_user}",
        "gists_url": "https://api.github.com/users/chtompki/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/chtompki/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/chtompki/subscriptions",
        "organizations_url": "https://api.github.com/users/chtompki/orgs",
        "repos_url": "https://api.github.com/users/chtompki/repos",
        "events_url": "https://api.github.com/users/chtompki/events{/privacy}",
        "received_events_url": "https://api.github.com/users/chtompki/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "parents": [
        {
            "sha": "a83c1eae04c9c99360c3ba4e6a46fd89dc5407ef",
            "url": "https://api.github.com/repos/apache/commons-beanutils/commits/a83c1eae04c9c99360c3ba4e6a46fd89dc5407ef",
            "html_url": "https://github.com/apache/commons-beanutils/commit/a83c1eae04c9c99360c3ba4e6a46fd89dc5407ef"
        }
    ],
    "stats": {
        "total": 78,
        "additions": 78,
        "deletions": 0
    },
    "files": [
        {
            "sha": "2126fe969b3eccb6fe1438a69420483c4d8fd742",
            "filename": "pom.xml",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/apache/commons-beanutils/blob/62e82ad92cf4818709d6044aaf257b73d42659a4/pom.xml",
            "raw_url": "https://github.com/apache/commons-beanutils/raw/62e82ad92cf4818709d6044aaf257b73d42659a4/pom.xml",
            "contents_url": "https://api.github.com/repos/apache/commons-beanutils/contents/pom.xml?ref=62e82ad92cf4818709d6044aaf257b73d42659a4",
            "patch": "@@ -195,6 +195,12 @@\n       <timezone>+0</timezone>\n       <organization>The Apache Software Foundation</organization>\n     </developer>\n+    <developer>\n+      <id>chtompki</id>\n+      <name>Rob Tompkins</name>\n+      <email>chtompki@apache.org</email>\n+      <organization>The Apache Software Foundation</organization>\n+    </developer>\n   </developers>\n \n   <contributors>\n@@ -298,6 +304,10 @@\n       <name>Bernhard Seebass</name>\n       <email />\n     </contributor>\n+    <contributor>\n+      <name>Melloware</name>\n+      <email />\n+    </contributor>\n   </contributors>\n \n   <dependencies>"
        },
        {
            "sha": "bf3ba3269c8e5bb191f5e3a7e22e4a2dbe182c99",
            "filename": "src/changes/changes.xml",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/apache/commons-beanutils/blob/62e82ad92cf4818709d6044aaf257b73d42659a4/src%2Fchanges%2Fchanges.xml",
            "raw_url": "https://github.com/apache/commons-beanutils/raw/62e82ad92cf4818709d6044aaf257b73d42659a4/src%2Fchanges%2Fchanges.xml",
            "contents_url": "https://api.github.com/repos/apache/commons-beanutils/contents/src%2Fchanges%2Fchanges.xml?ref=62e82ad92cf4818709d6044aaf257b73d42659a4",
            "patch": "@@ -29,6 +29,12 @@\n   </properties>\n   <body>\n \n+    <release version=\"1.9.4\" date=\"2019-06-08\" description=\"Bugfix for CVE-2014-0114\">\n+      <action issue=\"BEANUTILS-520\" dev=\"chtompki\" type=\"fix\" due-to=\"Melloware\">\n+        BeanUtils mitigate CVE-2014-0114.\n+      </action>\n+    </release>\n+\n     <release version=\"1.9.3\" date=\"2016-09-21\" description=\"Bug fix release, now builds with Java 8\">\n       <action issue=\"BEANUTILS-433\" dev=\"ggregory\" type=\"update\" due-to=\"Benedikt Ritter, Gary Gregory\">\n         Update dependency from JUnit 3.8.1 to 4.12."
        },
        {
            "sha": "36eb7f57bb51d8c33a15ceff1febe93412d2989d",
            "filename": "src/main/java/org/apache/commons/beanutils/PropertyUtilsBean.java",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/apache/commons-beanutils/blob/62e82ad92cf4818709d6044aaf257b73d42659a4/src%2Fmain%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2FPropertyUtilsBean.java",
            "raw_url": "https://github.com/apache/commons-beanutils/raw/62e82ad92cf4818709d6044aaf257b73d42659a4/src%2Fmain%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2FPropertyUtilsBean.java",
            "contents_url": "https://api.github.com/repos/apache/commons-beanutils/contents/src%2Fmain%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2FPropertyUtilsBean.java?ref=62e82ad92cf4818709d6044aaf257b73d42659a4",
            "patch": "@@ -188,6 +188,7 @@ public void setResolver(final Resolver resolver) {\n     public final void resetBeanIntrospectors() {\n         introspectors.clear();\n         introspectors.add(DefaultBeanIntrospector.INSTANCE);\n+        introspectors.add(SuppressPropertiesBeanIntrospector.SUPPRESS_CLASS);\n     }\n \n     /**"
        },
        {
            "sha": "95ad65e3da094ea830f92e474230bade0d73bcab",
            "filename": "src/test/java/org/apache/commons/beanutils/BeanIntrospectionDataTestCase.java",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/apache/commons-beanutils/blob/62e82ad92cf4818709d6044aaf257b73d42659a4/src%2Ftest%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2FBeanIntrospectionDataTestCase.java",
            "raw_url": "https://github.com/apache/commons-beanutils/raw/62e82ad92cf4818709d6044aaf257b73d42659a4/src%2Ftest%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2FBeanIntrospectionDataTestCase.java",
            "contents_url": "https://api.github.com/repos/apache/commons-beanutils/contents/src%2Ftest%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2FBeanIntrospectionDataTestCase.java?ref=62e82ad92cf4818709d6044aaf257b73d42659a4",
            "patch": "@@ -42,6 +42,7 @@ public class BeanIntrospectionDataTestCase extends TestCase {\n      */\n     private static PropertyDescriptor[] fetchDescriptors() {\n         final PropertyUtilsBean pub = new PropertyUtilsBean();\n+        pub.removeBeanIntrospector(SuppressPropertiesBeanIntrospector.SUPPRESS_CLASS);\n         pub.addBeanIntrospector(new FluentPropertyBeanIntrospector());\n         return pub.getPropertyDescriptors(BEAN_CLASS);\n     }"
        },
        {
            "sha": "869d630ecf156994b90c9ba71b29550acc3040b6",
            "filename": "src/test/java/org/apache/commons/beanutils/bugs/Jira157TestCase.java",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/apache/commons-beanutils/blob/62e82ad92cf4818709d6044aaf257b73d42659a4/src%2Ftest%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2Fbugs%2FJira157TestCase.java",
            "raw_url": "https://github.com/apache/commons-beanutils/raw/62e82ad92cf4818709d6044aaf257b73d42659a4/src%2Ftest%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2Fbugs%2FJira157TestCase.java",
            "contents_url": "https://api.github.com/repos/apache/commons-beanutils/contents/src%2Ftest%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2Fbugs%2FJira157TestCase.java?ref=62e82ad92cf4818709d6044aaf257b73d42659a4",
            "patch": "@@ -24,6 +24,8 @@\n import junit.framework.TestSuite;\n \n import org.apache.commons.beanutils.BeanUtils;\n+import org.apache.commons.beanutils.BeanUtilsBean;\n+import org.apache.commons.beanutils.SuppressPropertiesBeanIntrospector;\n import org.apache.commons.logging.Log;\n import org.apache.commons.logging.LogFactory;\n \n@@ -74,6 +76,9 @@ public static Test suite() {\n     @Override\n     protected void setUp() throws Exception {\n         super.setUp();\n+        BeanUtilsBean custom = new BeanUtilsBean();\n+        custom.getPropertyUtils().removeBeanIntrospector(SuppressPropertiesBeanIntrospector.SUPPRESS_CLASS);\n+        BeanUtilsBean.setInstance(custom);\n     }\n \n     /**"
        },
        {
            "sha": "ab64bcd2a6319438225645b4ee3be32971efc168",
            "filename": "src/test/java/org/apache/commons/beanutils/bugs/Jira520TestCase.java",
            "status": "added",
            "additions": 55,
            "deletions": 0,
            "changes": 55,
            "blob_url": "https://github.com/apache/commons-beanutils/blob/62e82ad92cf4818709d6044aaf257b73d42659a4/src%2Ftest%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2Fbugs%2FJira520TestCase.java",
            "raw_url": "https://github.com/apache/commons-beanutils/raw/62e82ad92cf4818709d6044aaf257b73d42659a4/src%2Ftest%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2Fbugs%2FJira520TestCase.java",
            "contents_url": "https://api.github.com/repos/apache/commons-beanutils/contents/src%2Ftest%2Fjava%2Forg%2Fapache%2Fcommons%2Fbeanutils%2Fbugs%2FJira520TestCase.java?ref=62e82ad92cf4818709d6044aaf257b73d42659a4",
            "patch": "@@ -0,0 +1,55 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.commons.beanutils.bugs;\n+\n+import org.apache.commons.beanutils.AlphaBean;\n+import org.apache.commons.beanutils.BeanUtilsBean;\n+import org.apache.commons.beanutils.SuppressPropertiesBeanIntrospector;\n+\n+import junit.framework.TestCase;\n+\n+/**\n+ * Fix CVE: https://nvd.nist.gov/vuln/detail/CVE-2014-0114\n+ *\n+ * @see <a href=\"https://issues.apache.org/jira/browse/BEANUTILS-520\">https://issues.apache.org/jira/browse/BEANUTILS-520</a>\n+ */\n+public class Jira520TestCase extends TestCase {\n+    /**\n+     * By default opt-in to security that does not allow access to \"class\".\n+     */\n+    public void testSuppressClassPropertyByDefault() throws Exception {\n+        final BeanUtilsBean bub = new BeanUtilsBean();\n+        final AlphaBean bean = new AlphaBean();\n+        try {\n+            bub.getProperty(bean, \"class\");\n+            fail(\"Could access class property!\");\n+        } catch (final NoSuchMethodException ex) {\n+            // ok\n+        }\n+    }\n+\n+    /**\n+     * Allow opt-out to make your app less secure but allow access to \"class\".\n+     */\n+    public void testAllowAccessToClassProperty() throws Exception {\n+        final BeanUtilsBean bub = new BeanUtilsBean();\n+        bub.getPropertyUtils().removeBeanIntrospector(SuppressPropertiesBeanIntrospector.SUPPRESS_CLASS);\n+        final AlphaBean bean = new AlphaBean();\n+        String result = bub.getProperty(bean, \"class\");\n+        assertEquals(\"Class property should have been accessed\", \"class org.apache.commons.beanutils.AlphaBean\", result);\n+    }\n+}\n\\ No newline at end of file"
        }
    ]
}