{
    "sha": "7c77ac0397a1f93c69d2776a13c31957f55d1647",
    "node_id": "MDY6Q29tbWl0MzIyMTk2MjQ6N2M3N2FjMDM5N2ExZjkzYzY5ZDI3NzZhMTNjMzE5NTdmNTVkMTY0Nw==",
    "commit": {
        "author": {
            "name": "joehni",
            "email": "joerg.schaible@gmx.de",
            "date": "2015-10-01T22:18:35Z"
        },
        "committer": {
            "name": "joehni",
            "email": "joerg.schaible@gmx.de",
            "date": "2015-10-01T22:18:35Z"
        },
        "message": "Fix XXE vulnerability for Dom4JDriver.",
        "tree": {
            "sha": "17ac5b15cc35e1919c4bbdfa0ae94a5573828567",
            "url": "https://api.github.com/repos/x-stream/xstream/git/trees/17ac5b15cc35e1919c4bbdfa0ae94a5573828567"
        },
        "url": "https://api.github.com/repos/x-stream/xstream/git/commits/7c77ac0397a1f93c69d2776a13c31957f55d1647",
        "comment_count": 0,
        "verification": {
            "verified": false,
            "reason": "unsigned",
            "signature": null,
            "payload": null,
            "verified_at": null
        }
    },
    "url": "https://api.github.com/repos/x-stream/xstream/commits/7c77ac0397a1f93c69d2776a13c31957f55d1647",
    "html_url": "https://github.com/x-stream/xstream/commit/7c77ac0397a1f93c69d2776a13c31957f55d1647",
    "comments_url": "https://api.github.com/repos/x-stream/xstream/commits/7c77ac0397a1f93c69d2776a13c31957f55d1647/comments",
    "author": {
        "login": "joehni",
        "id": 795149,
        "node_id": "MDQ6VXNlcjc5NTE0OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/795149?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/joehni",
        "html_url": "https://github.com/joehni",
        "followers_url": "https://api.github.com/users/joehni/followers",
        "following_url": "https://api.github.com/users/joehni/following{/other_user}",
        "gists_url": "https://api.github.com/users/joehni/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/joehni/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/joehni/subscriptions",
        "organizations_url": "https://api.github.com/users/joehni/orgs",
        "repos_url": "https://api.github.com/users/joehni/repos",
        "events_url": "https://api.github.com/users/joehni/events{/privacy}",
        "received_events_url": "https://api.github.com/users/joehni/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "committer": {
        "login": "joehni",
        "id": 795149,
        "node_id": "MDQ6VXNlcjc5NTE0OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/795149?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/joehni",
        "html_url": "https://github.com/joehni",
        "followers_url": "https://api.github.com/users/joehni/followers",
        "following_url": "https://api.github.com/users/joehni/following{/other_user}",
        "gists_url": "https://api.github.com/users/joehni/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/joehni/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/joehni/subscriptions",
        "organizations_url": "https://api.github.com/users/joehni/orgs",
        "repos_url": "https://api.github.com/users/joehni/repos",
        "events_url": "https://api.github.com/users/joehni/events{/privacy}",
        "received_events_url": "https://api.github.com/users/joehni/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "parents": [
        {
            "sha": "87172cfc1dd7f8f6e137963c778b03efd14ac446",
            "url": "https://api.github.com/repos/x-stream/xstream/commits/87172cfc1dd7f8f6e137963c778b03efd14ac446",
            "html_url": "https://github.com/x-stream/xstream/commit/87172cfc1dd7f8f6e137963c778b03efd14ac446"
        }
    ],
    "stats": {
        "total": 34,
        "additions": 24,
        "deletions": 10
    },
    "files": [
        {
            "sha": "a71de17da0cd8e75555bbd119bda5ad918188875",
            "filename": "xstream/src/java/com/thoughtworks/xstream/io/xml/Dom4JDriver.java",
            "status": "modified",
            "additions": 23,
            "deletions": 9,
            "changes": 32,
            "blob_url": "https://github.com/x-stream/xstream/blob/7c77ac0397a1f93c69d2776a13c31957f55d1647/xstream%2Fsrc%2Fjava%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FDom4JDriver.java",
            "raw_url": "https://github.com/x-stream/xstream/raw/7c77ac0397a1f93c69d2776a13c31957f55d1647/xstream%2Fsrc%2Fjava%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FDom4JDriver.java",
            "contents_url": "https://api.github.com/repos/x-stream/xstream/contents/xstream%2Fsrc%2Fjava%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FDom4JDriver.java?ref=7c77ac0397a1f93c69d2776a13c31957f55d1647",
            "patch": "@@ -1,6 +1,6 @@\n /*\n  * Copyright (C) 2004, 2005, 2006 Joe Walnes.\n- * Copyright (C) 2006, 2007, 2009, 2011, 2014 XStream Committers.\n+ * Copyright (C) 2006, 2007, 2009, 2011, 2014, 2015 XStream Committers.\n  * All rights reserved.\n  *\n  * The software in this package is published under the terms of the BSD\n@@ -26,6 +26,7 @@\n import org.dom4j.io.OutputFormat;\n import org.dom4j.io.SAXReader;\n import org.dom4j.io.XMLWriter;\n+import org.xml.sax.SAXException;\n \n import com.thoughtworks.xstream.io.HierarchicalStreamReader;\n import com.thoughtworks.xstream.io.HierarchicalStreamWriter;\n@@ -92,8 +93,7 @@ public void setOutputFormat(final OutputFormat outputFormat) {\n     @Override\n     public HierarchicalStreamReader createReader(final Reader text) {\n         try {\n-            final SAXReader reader = new SAXReader();\n-            final Document document = reader.read(text);\n+            final Document document = createReader().read(text);\n             return new Dom4JReader(document, getNameCoder());\n         } catch (final DocumentException e) {\n             throw new StreamException(e);\n@@ -103,8 +103,7 @@ public HierarchicalStreamReader createReader(final Reader text) {\n     @Override\n     public HierarchicalStreamReader createReader(final InputStream in) {\n         try {\n-            final SAXReader reader = new SAXReader();\n-            final Document document = reader.read(in);\n+            final Document document = createReader().read(in);\n             return new Dom4JReader(document, getNameCoder());\n         } catch (final DocumentException e) {\n             throw new StreamException(e);\n@@ -117,8 +116,7 @@ public HierarchicalStreamReader createReader(final InputStream in) {\n     @Override\n     public HierarchicalStreamReader createReader(final URL in) {\n         try {\n-            final SAXReader reader = new SAXReader();\n-            final Document document = reader.read(in);\n+            final Document document = createReader().read(in);\n             return new Dom4JReader(document, getNameCoder());\n         } catch (final DocumentException e) {\n             throw new StreamException(e);\n@@ -131,8 +129,7 @@ public HierarchicalStreamReader createReader(final URL in) {\n     @Override\n     public HierarchicalStreamReader createReader(final File in) {\n         try {\n-            final SAXReader reader = new SAXReader();\n-            final Document document = reader.read(in);\n+            final Document document = createReader().read(in);\n             return new Dom4JReader(document, getNameCoder());\n         } catch (final DocumentException e) {\n             throw new StreamException(e);\n@@ -157,4 +154,21 @@ public HierarchicalStreamWriter createWriter(final OutputStream out) {\n         final Writer writer = new OutputStreamWriter(out);\n         return createWriter(writer);\n     }\n+\n+    /**\n+     * Create and initialize the SAX reader.\n+     * \n+     * @return the SAX reader instance.\n+     * @throws DocumentException if DOCTYPE processing cannot be disabled\n+     * @since upcoming\n+     */\n+    protected SAXReader createReader() throws DocumentException {\n+        final SAXReader reader = new SAXReader();\n+        try {\n+            reader.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n+        } catch (SAXException e) {\n+            throw new DocumentException(\"Cannot disable DOCTYPE processing\", e);\n+        }\n+        return reader;\n+    }\n }"
        },
        {
            "sha": "350af5a7e5af31ca52360725ca8ee37b5db29d6e",
            "filename": "xstream/src/test/com/thoughtworks/xstream/io/xml/Dom4JReaderTest.java",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/x-stream/xstream/blob/7c77ac0397a1f93c69d2776a13c31957f55d1647/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FDom4JReaderTest.java",
            "raw_url": "https://github.com/x-stream/xstream/raw/7c77ac0397a1f93c69d2776a13c31957f55d1647/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FDom4JReaderTest.java",
            "contents_url": "https://api.github.com/repos/x-stream/xstream/contents/xstream%2Fsrc%2Ftest%2Fcom%2Fthoughtworks%2Fxstream%2Fio%2Fxml%2FDom4JReaderTest.java?ref=7c77ac0397a1f93c69d2776a13c31957f55d1647",
            "patch": "@@ -52,7 +52,7 @@ public void testIsXXEVulnerable() throws Exception {\n             fail(\"Thrown \" + XStreamException.class.getName() + \" expected\");\n         } catch (final XStreamException e) {\n             final String message = e.getMessage();\n-            if (message.contains(\"Package\")) {\n+            if (!message.contains(\"DOCTYPE\")) {\n                 throw e;\n             }\n         }"
        }
    ]
}