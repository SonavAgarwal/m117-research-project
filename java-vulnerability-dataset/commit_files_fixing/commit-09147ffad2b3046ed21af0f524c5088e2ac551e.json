{
    "sha": "09147ffad2b3046ed21af0f524c5088e2ac551e6",
    "node_id": "MDY6Q29tbWl0MTU5Mjg2NTA6MDkxNDdmZmFkMmIzMDQ2ZWQyMWFmMGY1MjRjNTA4OGUyYWM1NTFlNg==",
    "commit": {
        "author": {
            "name": "James Mitchell",
            "email": "jmitchell@apache.org",
            "date": "2008-01-24T07:39:45Z"
        },
        "committer": {
            "name": "James Mitchell",
            "email": "jmitchell@apache.org",
            "date": "2008-01-24T07:39:45Z"
        },
        "message": "WW-2414 - failsafe sanitization of querystring params\n\ngit-svn-id: https://svn.apache.org/repos/asf/struts/struts2/trunk@614814 13f79535-47bb-0310-9956-ffa450edef68",
        "tree": {
            "sha": "fc78e3ef6f5c2d7c5e89ac1d4777fa414ac99b63",
            "url": "https://api.github.com/repos/apache/struts/git/trees/fc78e3ef6f5c2d7c5e89ac1d4777fa414ac99b63"
        },
        "url": "https://api.github.com/repos/apache/struts/git/commits/09147ffad2b3046ed21af0f524c5088e2ac551e6",
        "comment_count": 0,
        "verification": {
            "verified": false,
            "reason": "unsigned",
            "signature": null,
            "payload": null,
            "verified_at": null
        }
    },
    "url": "https://api.github.com/repos/apache/struts/commits/09147ffad2b3046ed21af0f524c5088e2ac551e6",
    "html_url": "https://github.com/apache/struts/commit/09147ffad2b3046ed21af0f524c5088e2ac551e6",
    "comments_url": "https://api.github.com/repos/apache/struts/commits/09147ffad2b3046ed21af0f524c5088e2ac551e6/comments",
    "author": null,
    "committer": null,
    "parents": [
        {
            "sha": "28ee8f79d1f8e526a424f56f8c0a105cdcd14de9",
            "url": "https://api.github.com/repos/apache/struts/commits/28ee8f79d1f8e526a424f56f8c0a105cdcd14de9",
            "html_url": "https://github.com/apache/struts/commit/28ee8f79d1f8e526a424f56f8c0a105cdcd14de9"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 7,
        "deletions": 3
    },
    "files": [
        {
            "sha": "5b6ca1f53d57183f06e60f0ce3c8730e0be7ebc3",
            "filename": "core/src/main/java/org/apache/struts2/views/util/UrlHelper.java",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/apache/struts/blob/09147ffad2b3046ed21af0f524c5088e2ac551e6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fviews%2Futil%2FUrlHelper.java",
            "raw_url": "https://github.com/apache/struts/raw/09147ffad2b3046ed21af0f524c5088e2ac551e6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fviews%2Futil%2FUrlHelper.java",
            "contents_url": "https://api.github.com/repos/apache/struts/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fstruts2%2Fviews%2Futil%2FUrlHelper.java?ref=09147ffad2b3046ed21af0f524c5088e2ac551e6",
            "patch": "@@ -174,10 +174,14 @@ else if ((scheme != null) && !scheme.equals(request.getScheme())) {\n             buildParametersString(params, link, \"&\");\n         } \n \n-        String result;\n-\n+        String result = link.toString();\n+        \n+        if (result.indexOf(\"<script>\") >= 0){\n+        \tresult = result.replaceAll(\"<script>\", \"script\");\n+        }\n+        \n         try {\n-            result = encodeResult ? response.encodeURL(link.toString()) : link.toString();\n+            result = encodeResult ? response.encodeURL(result) : result;\n         } catch (Exception ex) {\n             // Could not encode the URL for some reason\n             // Use it unchanged"
        }
    ]
}