{
    "sha": "1f464b9412e1b1c08d40c8ffac40edd52731da48",
    "node_id": "MDY6Q29tbWl0MjA2Mzg3OjFmNDY0Yjk0MTJlMWIxYzA4ZDQwYzhmZmFjNDBlZGQ1MjczMWRhNDg=",
    "commit": {
        "author": {
            "name": "Bosanac Dejan",
            "email": "dejanb@apache.org",
            "date": "2010-02-23T15:38:26Z"
        },
        "committer": {
            "name": "Bosanac Dejan",
            "email": "dejanb@apache.org",
            "date": "2010-02-23T15:38:26Z"
        },
        "message": "merging 915269,915384 - https://issues.apache.org/activemq/browse/AMQ-2613 - XSS and CSRF vunerabilities\n\ngit-svn-id: https://svn.apache.org/repos/asf/activemq/branches/activemq-5.3@915387 13f79535-47bb-0310-9956-ffa450edef68",
        "tree": {
            "sha": "bb4ab54e685c39512ba0ab9675eeb8caa5f141c2",
            "url": "https://api.github.com/repos/apache/activemq/git/trees/bb4ab54e685c39512ba0ab9675eeb8caa5f141c2"
        },
        "url": "https://api.github.com/repos/apache/activemq/git/commits/1f464b9412e1b1c08d40c8ffac40edd52731da48",
        "comment_count": 0,
        "verification": {
            "verified": false,
            "reason": "unsigned",
            "signature": null,
            "payload": null,
            "verified_at": null
        }
    },
    "url": "https://api.github.com/repos/apache/activemq/commits/1f464b9412e1b1c08d40c8ffac40edd52731da48",
    "html_url": "https://github.com/apache/activemq/commit/1f464b9412e1b1c08d40c8ffac40edd52731da48",
    "comments_url": "https://api.github.com/repos/apache/activemq/commits/1f464b9412e1b1c08d40c8ffac40edd52731da48/comments",
    "author": {
        "login": "dejanb",
        "id": 141611,
        "node_id": "MDQ6VXNlcjE0MTYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/141611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dejanb",
        "html_url": "https://github.com/dejanb",
        "followers_url": "https://api.github.com/users/dejanb/followers",
        "following_url": "https://api.github.com/users/dejanb/following{/other_user}",
        "gists_url": "https://api.github.com/users/dejanb/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/dejanb/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dejanb/subscriptions",
        "organizations_url": "https://api.github.com/users/dejanb/orgs",
        "repos_url": "https://api.github.com/users/dejanb/repos",
        "events_url": "https://api.github.com/users/dejanb/events{/privacy}",
        "received_events_url": "https://api.github.com/users/dejanb/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "committer": {
        "login": "dejanb",
        "id": 141611,
        "node_id": "MDQ6VXNlcjE0MTYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/141611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dejanb",
        "html_url": "https://github.com/dejanb",
        "followers_url": "https://api.github.com/users/dejanb/followers",
        "following_url": "https://api.github.com/users/dejanb/following{/other_user}",
        "gists_url": "https://api.github.com/users/dejanb/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/dejanb/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dejanb/subscriptions",
        "organizations_url": "https://api.github.com/users/dejanb/orgs",
        "repos_url": "https://api.github.com/users/dejanb/repos",
        "events_url": "https://api.github.com/users/dejanb/events{/privacy}",
        "received_events_url": "https://api.github.com/users/dejanb/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "parents": [
        {
            "sha": "e440e903e206cac9832ca2c56592e6aaec844b81",
            "url": "https://api.github.com/repos/apache/activemq/commits/e440e903e206cac9832ca2c56592e6aaec844b81",
            "html_url": "https://github.com/apache/activemq/commit/e440e903e206cac9832ca2c56592e6aaec844b81"
        }
    ],
    "stats": {
        "total": 116,
        "additions": 82,
        "deletions": 34
    },
    "files": [
        {
            "sha": "c252042256482c06fcd5956b333ea4a354504513",
            "filename": "activemq-web-console/src/main/java/org/apache/activemq/web/controller/CreateDestination.java",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2Fcontroller%2FCreateDestination.java",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2Fcontroller%2FCreateDestination.java",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2Fcontroller%2FCreateDestination.java?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -39,4 +39,10 @@ public ModelAndView handleRequest(HttpServletRequest request, HttpServletRespons\n         return redirectToBrowseView();\n     }\n \n+\tpublic String[] getSupportedHttpMethods() {\n+\t\treturn new String[]{\"POST\"};\n+\t}\n+    \n+    \n+\n }"
        },
        {
            "sha": "fb87ae3595da15ef2136f7ccf4b6ea9a82ff3590",
            "filename": "activemq-web-console/src/main/java/org/apache/activemq/web/controller/CreateSubscriber.java",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2Fcontroller%2FCreateSubscriber.java",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2Fcontroller%2FCreateSubscriber.java",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2Fcontroller%2FCreateSubscriber.java?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -50,5 +50,9 @@ public ModelAndView handleRequest(HttpServletRequest request, HttpServletRespons\n         getBrokerAdmin().createDurableSubscriber(getClientId(), getSubscriberName(), getValidDestination(), selector);\n         return new ModelAndView(\"redirect:subscribers.jsp\");\n     }\n+    \n+\tpublic String[] getSupportedHttpMethods() {\n+\t\treturn new String[]{\"POST\"};\n+\t}\n \n }"
        },
        {
            "sha": "037927b7ca46d246fd9369c3c89fc3ca1f3c37e3",
            "filename": "activemq-web-console/src/main/java/org/apache/activemq/web/controller/SendMessage.java",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2Fcontroller%2FSendMessage.java",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2Fcontroller%2FSendMessage.java",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2Fcontroller%2FSendMessage.java?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -209,4 +209,8 @@ protected boolean isValidPropertyName(String name) {\n         // allow JMSX extensions or non JMS properties\n         return name.startsWith(\"JMSX\") || !name.startsWith(\"JMS\");\n     }\n+    \n+\tpublic String[] getSupportedHttpMethods() {\n+\t\treturn new String[]{\"POST\"};\n+\t}\n }"
        },
        {
            "sha": "6f899286a0666929d4c45e0a8b78433270f69e32",
            "filename": "activemq-web-console/src/main/java/org/apache/activemq/web/handler/BindingBeanNameUrlHandlerMapping.java",
            "status": "modified",
            "additions": 19,
            "deletions": 1,
            "changes": 20,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2Fhandler%2FBindingBeanNameUrlHandlerMapping.java",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2Fhandler%2FBindingBeanNameUrlHandlerMapping.java",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2Fhandler%2FBindingBeanNameUrlHandlerMapping.java?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -16,8 +16,12 @@\n  */\n package org.apache.activemq.web.handler;\n \n+import java.util.Arrays;\n+import java.util.UUID;\n+\n import javax.servlet.http.HttpServletRequest;\n \n+import org.apache.activemq.web.DestinationFacade;\n import org.apache.commons.logging.Log;\n import org.apache.commons.logging.LogFactory;\n import org.springframework.web.bind.ServletRequestDataBinder;\n@@ -41,8 +45,21 @@ protected Object getHandlerInternal(HttpServletRequest request) throws Exception\n             HandlerExecutionChain handlerExecutionChain = (HandlerExecutionChain) object;\n             object = handlerExecutionChain.getHandler();\n         }\n-\n+        \n         if (object != null) {\n+        \t// prevent CSRF attacks\n+        \tif (object instanceof DestinationFacade) {\n+        \t\t// check supported methods\n+        \t\tif (!Arrays.asList(((DestinationFacade)object).getSupportedHttpMethods()).contains(request.getMethod())) {\n+        \t\t\tthrow new UnsupportedOperationException(\"Unsupported method \" + request.getMethod() + \" for path \" + request.getRequestURI());\n+        \t\t}\n+        \t\t// check the 'secret'\n+        \t\tif (!request.getSession().getAttribute(\"secret\").equals(request.getParameter(\"secret\"))) {\n+        \t\t\tthrow new UnsupportedOperationException(\"Possible CSRF attack\");\n+        \t\t}\n+        \t}\n+        \t\n+        \t\n             ServletRequestDataBinder binder = new ServletRequestDataBinder(object, \"request\");\n             try {\n                 binder.bind(request);\n@@ -56,6 +73,7 @@ protected Object getHandlerInternal(HttpServletRequest request) throws Exception\n                 throw e;\n             }\n         }\n+        \n         return object;\n     }\n }"
        },
        {
            "sha": "ed82a97e172b34fb4059eafa5b36f57560288016",
            "filename": "activemq-web-console/src/main/webapp/WEB-INF/tags/form/short.tag",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Ftags%2Fform%2Fshort.tag",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Ftags%2Fform%2Fshort.tag",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Ftags%2Fform%2Fshort.tag?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -17,6 +17,8 @@\n <%@ attribute name=\"text\" type=\"java.lang.String\" required=\"true\"  %>\n <%@ attribute name=\"length\" type=\"java.lang.Integer\" required=\"false\" %>\n <%\n+ text = org.apache.commons.lang.StringEscapeUtils.escapeHtml(text);\n+ text = org.apache.commons.lang.StringEscapeUtils.escapeJavaScript(text);\n  if (length == null)\n     length = 20;\n  if (text.length() <= 20) {"
        },
        {
            "sha": "521bc6da9aa6e7edb1b6d7cf7cacafb6355a7594",
            "filename": "activemq-web-console/src/main/webapp/WEB-INF/tags/form/text.tag",
            "status": "modified",
            "additions": 7,
            "deletions": 5,
            "changes": 12,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Ftags%2Fform%2Ftext.tag",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Ftags%2Fform%2Ftext.tag",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Ftags%2Fform%2Ftext.tag?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -19,10 +19,12 @@\n <%\n     String value = request.getParameter(name);\n     if (value == null || value.trim().length() == 0) {\n-    \t\tvalue = defaultValue;\n-\t\t}\n-\t\tif (value == null) {\n-\t\t\tvalue = \"\";\n-\t\t}\n+    \tvalue = defaultValue;\n+\t}\n+\tif (value == null) {\n+\t\tvalue = \"\";\n+\t}\n+\tvalue = org.apache.commons.lang.StringEscapeUtils.escapeHtml(value);\n+\n %>\n <input type=\"text\" name=\"${name}\" value=\"<%= value %>\"/>"
        },
        {
            "sha": "5bc4eefcdbfd48dcf9df871fbed8fb2e16567886",
            "filename": "activemq-web-console/src/main/webapp/WEB-INF/web.xml",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -50,7 +50,7 @@\n \n   <filter-mapping>\n     <filter-name>spring</filter-name>\n-    <url-pattern>/*</url-pattern>\n+    <url-pattern>*.jsp</url-pattern>\n   </filter-mapping>\n \n   <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->\n@@ -101,7 +101,7 @@\n \n   <filter-mapping>\n     <filter-name>session</filter-name>\n-    <url-pattern>/*</url-pattern>\n+    <url-pattern>*.jsp</url-pattern>\n   </filter-mapping>\n   <filter-mapping>\n     <filter-name>spring-rq</filter-name>"
        },
        {
            "sha": "6e7c4ec05c61def0936911adef96b14581a1df9b",
            "filename": "activemq-web-console/src/main/webapp/browse.jsp",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fbrowse.jsp",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fbrowse.jsp",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fbrowse.jsp?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -39,7 +39,7 @@\n <tbody>\n <jms:forEachMessage queueBrowser=\"${requestContext.queueBrowser.browser}\" var=\"row\">\n <tr>\n-<td><a href=\"message.jsp?id=${row.JMSMessageID}&JMSDestination=${requestContext.queueBrowser.JMSDestination}\" \n+<td><a href=\"message.jsp?id=${row.JMSMessageID}&JMSDestination=<c:out value=\"${requestContext.queueBrowser.JMSDestination}\" />\" \n     title=\"${row.properties}\">${row.JMSMessageID}</a></td>\n <td>${row.JMSCorrelationID}</td>\n <td><jms:persistent message=\"${row}\"/></td>\n@@ -49,15 +49,15 @@\n <td><jms:formatTimestamp timestamp=\"${row.JMSTimestamp}\"/></td>\n <td>${row.JMSType}</td>\n <td>\n-    <a href=\"deleteMessage.action?JMSDestination=${row.JMSDestination}&messageId=${row.JMSMessageID}\">Delete</a>\n+    <a href=\"deleteMessage.action?JMSDestination=<c:out value=\"${row.JMSDestination}\"/>&messageId=${row.JMSMessageID}&secret=<c:out value='${sessionScope[\"secret\"]}'/>\">Delete</a>\n </td>\n </tr>\n </jms:forEachMessage>\n </tbody>\n </table>\n \n <div>\n-<a href=\"queueConsumers.jsp?JMSDestination=${requestContext.queueBrowser.JMSDestination}\">View Consumers</a>\n+<a href=\"queueConsumers.jsp?JMSDestination=<c:out value=\"${requestContext.queueBrowser.JMSDestination}\"/>\">View Consumers</a>\n </div>\n </body>\n </html>"
        },
        {
            "sha": "8736b9c12fa109c9ae529fb4bd435e18653d53af",
            "filename": "activemq-web-console/src/main/webapp/graph.jsp",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fgraph.jsp",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fgraph.jsp",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fgraph.jsp?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -51,7 +51,7 @@\n <td>${row.JMSTimestamp}</td>\n <td>${row.JMSType}</td>\n <td>\n-    <a href=\"deleteDestination.action?destination=${row.JMSMessageID}\">Delete</a>\n+    <a href=\"deleteDestination.action?destination=${row.JMSMessageID}&secret=<c:out value='${sessionScope[\"secret\"]}'/>\">Delete</a>\n </td>\n </tr>\n </jms:forEachMessage>"
        },
        {
            "sha": "b5db6aec1a53a37d2c5be0436298f705742e6fcd",
            "filename": "activemq-web-console/src/main/webapp/message.jsp",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fmessage.jsp",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fmessage.jsp",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fmessage.jsp?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -130,24 +130,24 @@ No message could be found for ID ${requestContext.messageQuery.id}\n                 </thead>\n                 <tbody>\n                     <tr>\n-                        <td colspan=\"2\"><a href=\"deleteMessage.action?JMSDestination=${row.JMSDestination}&messageId=${row.JMSMessageID}\">Delete</a></td>\n+                        <td colspan=\"2\"><a href=\"deleteMessage.action?JMSDestination=<c:out value=\"${row.JMSDestination}\" />&messageId=${row.JMSMessageID}&secret=<c:out value='${sessionScope[\"secret\"]}'/>\">Delete</a></td>\n                     </tr>\n                     <tr class=\"odd\">\n-                    <td><a href=\"javascript:confirmAction('queue', 'copyMessage.action?destination=%target%&JMSDestination=${row.JMSDestination}&messageId=${row.JMSMessageID}&JMSDestinationType=queue')\">Copy</a></td>\n+                    <td><a href=\"javascript:confirmAction('queue', 'copyMessage.action?destination=%target%&JMSDestination=<c:out value=\"${row.JMSDestination}\" />&messageId=${row.JMSMessageID}&JMSDestinationType=queue&secret=<c:out value='${sessionScope[\"secret\"]}'/>')\">Copy</a></td>\n                         <td rowspan=\"2\">\n                             <select id=\"queue\">\n                                 <option value=\"\"> -- Please select --</option>\n                                 <c:forEach items=\"${requestContext.brokerQuery.queues}\" var=\"queues\">\n                                     <c:if test=\"${queues.name != requestContext.messageQuery.JMSDestination}\">\n-                                    <option value=\"${queues.name}\"><form:short text=\"${queues.name}\"/></option>\n+                                    <option value=\"<c:out value=\"${queues.name}\" />\"><form:short text=\"${queues.name}\"/></option>\n                                     </c:if>\n                                 </c:forEach>\n                             </select>\n                         </td>\n                         \n                     </tr>\n                     <tr class=\"odd\">\n-                        <td><a href=\"javascript:confirmAction('queue', 'moveMessage.action?destination=%target%&JMSDestination=${row.JMSDestination}&messageId=${row.JMSMessageID}&JMSDestinationType=queue')\">Move</a></td>\n+                        <td><a href=\"javascript:confirmAction('queue', 'moveMessage.action?destination=%target%&JMSDestination=<c:out value=\"${row.JMSDestination}\" />&messageId=${row.JMSMessageID}&JMSDestinationType=queue&secret=<c:out value='${sessionScope[\"secret\"]}'/>')\">Move</a></td>\n                     </tr>\n                 </tbody>\n             </table>"
        },
        {
            "sha": "862c6075bf4c15de05f216f86441f88384386ffa",
            "filename": "activemq-web-console/src/main/webapp/queueConsumers.jsp",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2FqueueConsumers.jsp",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2FqueueConsumers.jsp",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2FqueueConsumers.jsp?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -16,11 +16,11 @@\n --%>\n <html>\n <head>\n-<title>Consumers for ${requestContext.queueConsumerQuery.JMSDestination}</title>\n+<title>Consumers for <c:out value=\"${requestContext.queueConsumerQuery.JMSDestination}\" /></title>\n </head>\n <body>\n \n-<h2>Active Consumers for ${requestContext.queueConsumerQuery.JMSDestination}</h2>\n+<h2>Active Consumers for <c:out value=\"${requestContext.queueConsumerQuery.JMSDestination}\" /></h2>\n \n <table id=\"messages\" class=\"sortable autostripe\">\n <thead>"
        },
        {
            "sha": "ab535e471dd677db24ec429a813b9b4cc5887b02",
            "filename": "activemq-web-console/src/main/webapp/queues.jsp",
            "status": "modified",
            "additions": 11,
            "deletions": 9,
            "changes": 20,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fqueues.jsp",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fqueues.jsp",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fqueues.jsp?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -21,8 +21,9 @@\n <body>\n \n <div>\n-<form action=\"createDestination.action\" method=\"get\">\n+<form action=\"createDestination.action\" method=\"post\">\n     <input type=\"hidden\" name=\"JMSDestinationType\" value=\"queue\"/>\n+    <input type=\"hidden\" name=\"secret\" value=\"<c:out value='${sessionScope[\"secret\"]}'/>\"/>\n \n     <label name=\"destination\">Queue Name</label>\n     <input type=\"text\" name=\"JMSDestination\" value=\"\"/>\n@@ -48,22 +49,23 @@\n </thead>\n <tbody>\n <c:forEach items=\"${requestContext.brokerQuery.queues}\" var=\"row\">\n+\n <tr>\n-<td><a href=\"browse.jsp?JMSDestination=${row.name}\"><form:tooltip text=\"${row.name}\" length=\"50\"/></a></td>\n+<td><a href=\"browse.jsp?JMSDestination=<c:out value=\"${row.name}\" />\"><form:tooltip text=\"${row.name}\" length=\"50\"/></a></td>\n <td>${row.queueSize}</td>\n <td>${row.consumerCount}</td>\n <td>${row.enqueueCount}</td>\n <td>${row.dequeueCount}</td>\n <td>\n-    <a href=\"browse.jsp?JMSDestination=${row.name}\">Browse</a>\n-\t<a href=\"queueConsumers.jsp?JMSDestination=${row.name}\">Active Consumers</a><br/>\n-    <a href=\"queueBrowse/${row.name}?view=rss&feedType=atom_1.0\" title=\"Atom 1.0\"><img src=\"images/feed_atom.png\"/></a>\n-    <a href=\"queueBrowse/${row.name}?view=rss&feedType=rss_2.0\" title=\"RSS 2.0\"><img src=\"images/feed_rss.png\"/></a>\n+    <a href=\"browse.jsp?JMSDestination=<c:out value=\"${row.name}\" />\">Browse</a>\n+\t<a href=\"queueConsumers.jsp?JMSDestination=<c:out value=\"${row.name}\" />\">Active Consumers</a><br/>\n+    <a href=\"queueBrowse/<c:out value=\"${row.name}\" />?view=rss&feedType=atom_1.0\" title=\"Atom 1.0\"><img src=\"images/feed_atom.png\"/></a>\n+    <a href=\"queueBrowse/<c:out value=\"${row.name}\" />?view=rss&feedType=rss_2.0\" title=\"RSS 2.0\"><img src=\"images/feed_rss.png\"/></a>\n </td>\n <td>\n-    <a href=\"send.jsp?JMSDestination=${row.name}&JMSDestinationType=queue\">Send To</a>\n-    <a href=\"purgeDestination.action?JMSDestination=${row.name}&JMSDestinationType=queue\">Purge</a>\n-    <a href=\"deleteDestination.action?JMSDestination=${row.name}&JMSDestinationType=queue\">Delete</a>\n+    <a href=\"send.jsp?JMSDestination=<c:out value=\"${row.name}\" />&JMSDestinationType=queue\">Send To</a>\n+    <a href=\"purgeDestination.action?JMSDestination=<c:out value=\"${row.name}\" />&JMSDestinationType=queue&secret=<c:out value='${sessionScope[\"secret\"]}'/>\">Purge</a>\n+    <a href=\"deleteDestination.action?JMSDestination=<c:out value=\"${row.name}\" />&JMSDestinationType=queue&secret=<c:out value='${sessionScope[\"secret\"]}'/>\">Delete</a>\n </td>\n </tr>\n </c:forEach>"
        },
        {
            "sha": "056c0a876a36e66cba758c43d6bfd2e3cf7511ca",
            "filename": "activemq-web-console/src/main/webapp/send.jsp",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fsend.jsp",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fsend.jsp",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fsend.jsp?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -23,6 +23,7 @@\n <h2>Send a JMS Message</h2>\n \n <form action=\"sendMessage.action\" method=\"post\">\n+<input type=\"hidden\" name=\"secret\" value=\"<c:out value='${sessionScope[\"secret\"]}'/>\"/>\n \n <table id=\"headers\" class=\"autostripe\">\n <thead>\n@@ -37,7 +38,7 @@\n \t    <label for=\"JMSDestination\">Destination</label>\n \t</td>\n \t<td>\n-\t    <form:text name=\"JMSDestination\"/>\n+\t    <form:text name=\"JMSDestination\" defaultValue=\"foo.bar\" />\n \t</td>\n \t<td class=\"label\">\n \t    <label for=\"queue\">Queue or Topic</label>"
        },
        {
            "sha": "843a035d80a12f214efebc36ba56b56c5554aa73",
            "filename": "activemq-web-console/src/main/webapp/subscribers.jsp",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fsubscribers.jsp",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fsubscribers.jsp",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Fsubscribers.jsp?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -20,8 +20,9 @@\n </head>\n <body>\n \n-<form action=\"createSubscriber.action\" method=\"get\">\n+<form action=\"createSubscriber.action\" method=\"post\">\n     <input type=\"hidden\" name=\"JMSDestinationType\" value=\"topic\"/>\n+    <input type=\"hidden\" name=\"secret\" value=\"<c:out value='${sessionScope[\"secret\"]}'/>\"/>\n \n <table id=\"createSubscribers\" class=\"sortable autostripe\">\n <thead>\n@@ -102,7 +103,7 @@\n <td>${row.enqueueCounter}</td>\n <td>${row.dequeueCounter}</td>\n <td>\n-    <a href=\"deleteSubscriber.action?clientId=${row.clientId}&subscriberName=${row.subscriptionName}\">Delete</a>\n+    <a href=\"deleteSubscriber.action?clientId=${row.clientId}&subscriberName=${row.subscriptionName}&secret=<c:out value='${sessionScope[\"secret\"]}'/>\">Delete</a>\n </td>\n </tr>\n </c:forEach>"
        },
        {
            "sha": "310333dd87418a008e070e91dd344a0069ddb995",
            "filename": "activemq-web-console/src/main/webapp/topics.jsp",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Ftopics.jsp",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Ftopics.jsp",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web-console%2Fsrc%2Fmain%2Fwebapp%2Ftopics.jsp?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -23,6 +23,7 @@\n <div>\n <form action=\"createDestination.action\" method=\"get\">\n     <input type=\"hidden\" name=\"JMSDestinationType\" value=\"topic\"/>\n+    <input type=\"hidden\" name=\"secret\" value=\"<c:out value='${sessionScope[\"secret\"]}'/>\"/>\n \n     <label name=\"destination\">Topic Name</label>\n     <input type=\"text\" name=\"JMSDestination\" value=\"\"/>\n@@ -46,13 +47,13 @@\n <tbody>\n <c:forEach items=\"${requestContext.brokerQuery.topics}\" var=\"row\">\n <tr>\n-<td><a href=\"send.jsp?JMSDestination=${row.name}&JMSDestinationType=topic\"><form:tooltip text=\"${row.name}\" length=\"50\"/></a></td>\n+<td><a href=\"send.jsp?JMSDestination=<c:out value=\"${row.name}\" />&JMSDestinationType=topic\"><form:tooltip text=\"${row.name}\" length=\"50\"/></a></td>\n <td>${row.consumerCount}</td>\n <td>${row.enqueueCount}</td>\n <td>${row.dequeueCount}</td>\n <td>\n-    <a href=\"send.jsp?JMSDestination=${row.name}&JMSDestinationType=topic\">Send To</a>\n-    <a href=\"deleteDestination.action?JMSDestination=${row.name}&JMSDestinationType=topic\">Delete</a>\n+    <a href=\"send.jsp?JMSDestination=<c:out value=\"${row.name}\" />&JMSDestinationType=topic\">Send To</a>\n+    <a href=\"deleteDestination.action?JMSDestination=<c:out value=\"${row.name}\" />&JMSDestinationType=topic&secret=<c:out value='${sessionScope[\"secret\"]}'/>\">Delete</a>\n </td>\n </tr>\n </c:forEach>"
        },
        {
            "sha": "f0273797937532e37061d5d5953c2de0b65ab8bf",
            "filename": "activemq-web/src/main/java/org/apache/activemq/web/BrokerFacadeSupport.java",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2FBrokerFacadeSupport.java",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2FBrokerFacadeSupport.java",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2FBrokerFacadeSupport.java?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -172,6 +172,7 @@ public Collection<NetworkConnectorViewMBean> getNetworkConnectors() throws Excep\n     @SuppressWarnings(\"unchecked\")\n     public Collection<SubscriptionViewMBean> getQueueConsumers(String queueName) throws Exception {\n         String brokerName = getBrokerName();\n+        queueName = StringUtils.replace(queueName, \"\\\"\", \"_\");\n         ObjectName query = new ObjectName(\"org.apache.activemq:BrokerName=\" + brokerName\n                 + \",Type=Subscription,destinationType=Queue,destinationName=\" + queueName + \",*\");\n         Set<ObjectName> queryResult = getManagementContext().queryNames(query, null);"
        },
        {
            "sha": "b7dfbf5948cfed64deeb183ddf44cb71d2a29605",
            "filename": "activemq-web/src/main/java/org/apache/activemq/web/DestinationFacade.java",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2FDestinationFacade.java",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2FDestinationFacade.java",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2FDestinationFacade.java?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -128,4 +128,8 @@ protected ModelAndView redirectToBrowseView() {\n     protected String getPhysicalDestinationName() {\n         return createDestination().getPhysicalName();\n     }\n+    \n+    public String[] getSupportedHttpMethods() {\n+    \treturn new String[]{\"GET\", \"POST\"};\n+    }\n }"
        },
        {
            "sha": "9a698836885d8ede0cda9d26d283f9ce60bd2926",
            "filename": "activemq-web/src/main/java/org/apache/activemq/web/SessionFilter.java",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/apache/activemq/blob/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2FSessionFilter.java",
            "raw_url": "https://github.com/apache/activemq/raw/1f464b9412e1b1c08d40c8ffac40edd52731da48/activemq-web%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2FSessionFilter.java",
            "contents_url": "https://api.github.com/repos/apache/activemq/contents/activemq-web%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fweb%2FSessionFilter.java?ref=1f464b9412e1b1c08d40c8ffac40edd52731da48",
            "patch": "@@ -18,6 +18,7 @@\n package org.apache.activemq.web;\n \n import java.io.IOException;\n+import java.util.UUID;\n \n import javax.servlet.Filter;\n import javax.servlet.FilterChain;\n@@ -39,7 +40,8 @@ public void init(FilterConfig filterConfig) throws ServletException {\n     }\n \n     public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {\n-        ((HttpServletRequest)request).getSession(true);\n+    \t// set secret to prevent CSRF attacks\n+        ((HttpServletRequest)request).getSession(true).setAttribute(\"secret\", UUID.randomUUID().toString());;\n         chain.doFilter(request, response);\n     }\n "
        }
    ]
}