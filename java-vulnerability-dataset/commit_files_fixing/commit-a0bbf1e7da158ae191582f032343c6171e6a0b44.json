{
    "sha": "a0bbf1e7da158ae191582f032343c6171e6a0b44",
    "node_id": "MDY6Q29tbWl0NDgxMjk4MjQ6YTBiYmYxZTdkYTE1OGFlMTkxNTgyZjAzMjM0M2M2MTcxZTZhMGI0NA==",
    "commit": {
        "author": {
            "name": "James Sutton",
            "email": "james.sutton@uk.ibm.com",
            "date": "2018-03-26T09:53:18Z"
        },
        "committer": {
            "name": "James Sutton",
            "email": "james.sutton@uk.ibm.com",
            "date": "2018-03-26T09:53:18Z"
        },
        "message": "Issue #506 - Honouring result of HostnameVerifier\n\nSigned-off-by: James Sutton <james.sutton@uk.ibm.com>",
        "tree": {
            "sha": "a7e5c41b48defa84319869d11843c75d66c2409a",
            "url": "https://api.github.com/repos/eclipse-paho/paho.mqtt.java/git/trees/a7e5c41b48defa84319869d11843c75d66c2409a"
        },
        "url": "https://api.github.com/repos/eclipse-paho/paho.mqtt.java/git/commits/a0bbf1e7da158ae191582f032343c6171e6a0b44",
        "comment_count": 0,
        "verification": {
            "verified": true,
            "reason": "valid",
            "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEUGjUv1Qz9Btro59YjE18McMSSpsFAlq4ww4ACgkQjE18McMS\nSpvwVg/+KBDwYWVdX7NrPvXvGzEp55JpA5WjGzJtMolTg2zZ5hnhZre4jgAc3wdq\nNBvRcmsDYcpYrfn2HsWa+LEhlQMnzO8a6bh/JeIgjLYGxMNtmBb5BEaxvjgoQ6Pj\n5x6K3ZgZCqXtlMTcGv3K2/RIrFwq97ay2vJ7zhJMabfAOt9TvThQPbECpQY0Zvee\ncEPhtpQ0KQBozZjAzTHbAmcEL2EWkWfGhWMU85SCGC5OM26rCFDeF70t9PiEFpe2\nkePH0paExkSR3h2mtC23TieZVbLUSEI0GuZ3kSUGK9Q6IywVTOxr4i4j5IIz1sh5\n3Jr5inlG66uid2at05SZbcz2fNbq5X5eSt2OMQuIYHTYRVX3iOu7gEABMvYhPF+3\nsRS/6XEsMmDTw0RdbZ7Xq0p5c/vZyHrhaxbffBUeY9utmTlq/Td4RHKFcvsDqrFZ\nZtnJF3sbAjT95SKsduKOszlI7Dq7LlIX2EkzI0Hd+E+h5/lfxw6/COi2ho5PrJ7A\npBNvJvdBI0uV0jo63PMMoDeizjwDx2akQMMvaiOQrerBIwGQd+cfv+KfDp/+hSGo\n5xVy/5nHb2EVdNYSMbnXountSkQWsOB74pnR3Gz8/SRyBaq0OxWeFYfR/VMRd/kr\ncBk3wGWcEuoGfZZNk3nlPCyoSvsrmx+CuLyanUw6D4SWmydi8m8=\n=JPgR\n-----END PGP SIGNATURE-----",
            "payload": "tree a7e5c41b48defa84319869d11843c75d66c2409a\nparent 3032359be73bb6f1d2879bb3d8bbbc983013b2b0\nauthor James Sutton <james.sutton@uk.ibm.com> 1522057998 +0100\ncommitter James Sutton <james.sutton@uk.ibm.com> 1522057998 +0100\n\nIssue #506 - Honouring result of HostnameVerifier\n\nSigned-off-by: James Sutton <james.sutton@uk.ibm.com>\n",
            "verified_at": "2024-11-12T20:38:06Z"
        }
    },
    "url": "https://api.github.com/repos/eclipse-paho/paho.mqtt.java/commits/a0bbf1e7da158ae191582f032343c6171e6a0b44",
    "html_url": "https://github.com/eclipse-paho/paho.mqtt.java/commit/a0bbf1e7da158ae191582f032343c6171e6a0b44",
    "comments_url": "https://api.github.com/repos/eclipse-paho/paho.mqtt.java/commits/a0bbf1e7da158ae191582f032343c6171e6a0b44/comments",
    "author": {
        "login": "jpwsutton",
        "id": 1068763,
        "node_id": "MDQ6VXNlcjEwNjg3NjM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1068763?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jpwsutton",
        "html_url": "https://github.com/jpwsutton",
        "followers_url": "https://api.github.com/users/jpwsutton/followers",
        "following_url": "https://api.github.com/users/jpwsutton/following{/other_user}",
        "gists_url": "https://api.github.com/users/jpwsutton/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jpwsutton/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jpwsutton/subscriptions",
        "organizations_url": "https://api.github.com/users/jpwsutton/orgs",
        "repos_url": "https://api.github.com/users/jpwsutton/repos",
        "events_url": "https://api.github.com/users/jpwsutton/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jpwsutton/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "committer": {
        "login": "jpwsutton",
        "id": 1068763,
        "node_id": "MDQ6VXNlcjEwNjg3NjM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1068763?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jpwsutton",
        "html_url": "https://github.com/jpwsutton",
        "followers_url": "https://api.github.com/users/jpwsutton/followers",
        "following_url": "https://api.github.com/users/jpwsutton/following{/other_user}",
        "gists_url": "https://api.github.com/users/jpwsutton/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jpwsutton/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jpwsutton/subscriptions",
        "organizations_url": "https://api.github.com/users/jpwsutton/orgs",
        "repos_url": "https://api.github.com/users/jpwsutton/repos",
        "events_url": "https://api.github.com/users/jpwsutton/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jpwsutton/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
    },
    "parents": [
        {
            "sha": "3032359be73bb6f1d2879bb3d8bbbc983013b2b0",
            "url": "https://api.github.com/repos/eclipse-paho/paho.mqtt.java/commits/3032359be73bb6f1d2879bb3d8bbbc983013b2b0",
            "html_url": "https://github.com/eclipse-paho/paho.mqtt.java/commit/3032359be73bb6f1d2879bb3d8bbbc983013b2b0"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 12,
        "deletions": 2
    },
    "files": [
        {
            "sha": "e93ab7549acf427e1791bf21ffe64312816f2e65",
            "filename": "org.eclipse.paho.client.mqttv3/src/main/java/org/eclipse/paho/client/mqttv3/internal/SSLNetworkModule.java",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/eclipse-paho/paho.mqtt.java/blob/a0bbf1e7da158ae191582f032343c6171e6a0b44/org.eclipse.paho.client.mqttv3%2Fsrc%2Fmain%2Fjava%2Forg%2Feclipse%2Fpaho%2Fclient%2Fmqttv3%2Finternal%2FSSLNetworkModule.java",
            "raw_url": "https://github.com/eclipse-paho/paho.mqtt.java/raw/a0bbf1e7da158ae191582f032343c6171e6a0b44/org.eclipse.paho.client.mqttv3%2Fsrc%2Fmain%2Fjava%2Forg%2Feclipse%2Fpaho%2Fclient%2Fmqttv3%2Finternal%2FSSLNetworkModule.java",
            "contents_url": "https://api.github.com/repos/eclipse-paho/paho.mqtt.java/contents/org.eclipse.paho.client.mqttv3%2Fsrc%2Fmain%2Fjava%2Forg%2Feclipse%2Fpaho%2Fclient%2Fmqttv3%2Finternal%2FSSLNetworkModule.java?ref=a0bbf1e7da158ae191582f032343c6171e6a0b44",
            "patch": "@@ -19,6 +19,7 @@\n \n import javax.net.ssl.HostnameVerifier;\n import javax.net.ssl.SSLParameters;\n+import javax.net.ssl.SSLPeerUnverifiedException;\n import javax.net.ssl.SSLSession;\n import javax.net.ssl.SSLSocket;\n import javax.net.ssl.SSLSocketFactory;\n@@ -137,7 +138,11 @@ public void start() throws IOException, MqttException {\n \t\t((SSLSocket) socket).startHandshake();\n \t\tif (hostnameVerifier != null && !this.httpsHostnameVerificationEnabled) {\n \t\t\tSSLSession session = ((SSLSocket) socket).getSession();\n-\t\t\thostnameVerifier.verify(host, session);\n+\t\t\tif(!hostnameVerifier.verify(host, session)) {\n+\t\t\t\tsession.invalidate();\n+\t\t\t\tsocket.close();\n+\t\t\t\tthrow new SSLPeerUnverifiedException(\"Host: \" + host + \", Peer Host: \" + session.getPeerHost());\n+\t\t\t}\n \t\t}\n \t\t// reset timeout to default value\n \t\tsocket.setSoTimeout(soTimeout);"
        },
        {
            "sha": "e99c3c658492d9829c0f463af3aea7bfb045841f",
            "filename": "org.eclipse.paho.mqttv5.client/src/main/java/org/eclipse/paho/mqttv5/client/internal/SSLNetworkModule.java",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/eclipse-paho/paho.mqtt.java/blob/a0bbf1e7da158ae191582f032343c6171e6a0b44/org.eclipse.paho.mqttv5.client%2Fsrc%2Fmain%2Fjava%2Forg%2Feclipse%2Fpaho%2Fmqttv5%2Fclient%2Finternal%2FSSLNetworkModule.java",
            "raw_url": "https://github.com/eclipse-paho/paho.mqtt.java/raw/a0bbf1e7da158ae191582f032343c6171e6a0b44/org.eclipse.paho.mqttv5.client%2Fsrc%2Fmain%2Fjava%2Forg%2Feclipse%2Fpaho%2Fmqttv5%2Fclient%2Finternal%2FSSLNetworkModule.java",
            "contents_url": "https://api.github.com/repos/eclipse-paho/paho.mqtt.java/contents/org.eclipse.paho.mqttv5.client%2Fsrc%2Fmain%2Fjava%2Forg%2Feclipse%2Fpaho%2Fmqttv5%2Fclient%2Finternal%2FSSLNetworkModule.java?ref=a0bbf1e7da158ae191582f032343c6171e6a0b44",
            "patch": "@@ -19,6 +19,7 @@\n \n import javax.net.ssl.HostnameVerifier;\n import javax.net.ssl.SSLParameters;\n+import javax.net.ssl.SSLPeerUnverifiedException;\n import javax.net.ssl.SSLSession;\n import javax.net.ssl.SSLSocket;\n import javax.net.ssl.SSLSocketFactory;\n@@ -135,7 +136,11 @@ public void start() throws IOException, MqttException {\n \t\t((SSLSocket) socket).startHandshake();\n \t\tif (hostnameVerifier != null) {\n \t\t\tSSLSession session = ((SSLSocket) socket).getSession();\n-\t\t\thostnameVerifier.verify(host, session);\n+\t\t\tif(!hostnameVerifier.verify(host, session)) {\n+\t\t\t\tsession.invalidate();\n+\t\t\t\tsocket.close();\n+\t\t\t\tthrow new SSLPeerUnverifiedException(\"Host: \" + host + \", Peer Host: \" + session.getPeerHost());\n+\t\t\t}\n \t\t}\n \t\t// reset timeout to default value\n \t\tsocket.setSoTimeout(soTimeout);"
        }
    ]
}